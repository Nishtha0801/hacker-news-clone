{"ast":null,"code":"import { useLayoutEffect, useEffect, useState, useRef, useCallback, useMemo, createElement, createContext, useContext, Fragment, isValidElement, cloneElement, forwardRef, useReducer, createRef } from 'react';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      return function () {\n        if (i >= o.length) return {\n          done: true\n        };\n        return {\n          done: false,\n          value: o[i++]\n        };\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  it = o[Symbol.iterator]();\n  return it.next.bind(it);\n}\n\nvar useIsoMorphicEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect; // didn't take care of the Suspense case. To fix this we used the approach the @reach-ui/auto-id\n// uses.\n//\n// Credits: https://github.com/reach/reach-ui/blob/develop/packages/auto-id/src/index.tsx\n\nvar state = {\n  serverHandoffComplete: false\n};\nvar id = 0;\n\nfunction generateId() {\n  return ++id;\n}\n\nfunction useId() {\n  var _React$useState = useState(state.serverHandoffComplete ? generateId : null),\n      id = _React$useState[0],\n      setId = _React$useState[1];\n\n  useIsoMorphicEffect(function () {\n    if (id === null) setId(generateId()); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(function () {\n    if (state.serverHandoffComplete === false) state.serverHandoffComplete = true;\n  }, []);\n  return id != null ? '' + id : undefined;\n}\n\nfunction useIsInitialRender() {\n  var initial = useRef(true);\n  useEffect(function () {\n    initial.current = false;\n  }, []);\n  return initial.current;\n}\n\nfunction useIsMounted() {\n  var mounted = useRef(true);\n  useEffect(function () {\n    return function () {\n      mounted.current = false;\n    };\n  }, []);\n  return mounted;\n}\n\nfunction match(value, lookup) {\n  if (value in lookup) {\n    var returnValue = lookup[value];\n\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n\n    return typeof returnValue === 'function' ? returnValue.apply(void 0, args) : returnValue;\n  }\n\n  var error = new Error(\"Tried to handle \\\"\" + value + \"\\\" but there is no handler defined. Only defined handlers are: \" + Object.keys(lookup).map(function (key) {\n    return \"\\\"\" + key + \"\\\"\";\n  }).join(', ') + \".\");\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(error, match);\n  }\n\n  throw error;\n}\n\nfunction once(cb) {\n  var state = {\n    called: false\n  };\n  return function () {\n    if (state.called) {\n      return;\n    }\n\n    state.called = true;\n    return cb.apply(void 0, arguments);\n  };\n}\n\nfunction disposables() {\n  var disposables = [];\n  var api = {\n    requestAnimationFrame: function (_requestAnimationFrame) {\n      function requestAnimationFrame() {\n        return _requestAnimationFrame.apply(this, arguments);\n      }\n\n      requestAnimationFrame.toString = function () {\n        return _requestAnimationFrame.toString();\n      };\n\n      return requestAnimationFrame;\n    }(function () {\n      var raf = requestAnimationFrame.apply(void 0, arguments);\n      api.add(function () {\n        return cancelAnimationFrame(raf);\n      });\n    }),\n    nextFrame: function nextFrame() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      api.requestAnimationFrame(function () {\n        api.requestAnimationFrame.apply(api, args);\n      });\n    },\n    setTimeout: function (_setTimeout) {\n      function setTimeout() {\n        return _setTimeout.apply(this, arguments);\n      }\n\n      setTimeout.toString = function () {\n        return _setTimeout.toString();\n      };\n\n      return setTimeout;\n    }(function () {\n      var timer = setTimeout.apply(void 0, arguments);\n      api.add(function () {\n        return clearTimeout(timer);\n      });\n    }),\n    add: function add(cb) {\n      disposables.push(cb);\n    },\n    dispose: function dispose() {\n      disposables.splice(0).forEach(function (dispose) {\n        return dispose();\n      });\n    }\n  };\n  return api;\n}\n\nfunction addClasses(node) {\n  var _node$classList;\n\n  for (var _len = arguments.length, classes = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    classes[_key - 1] = arguments[_key];\n  }\n\n  node && classes.length > 0 && (_node$classList = node.classList).add.apply(_node$classList, classes);\n}\n\nfunction removeClasses(node) {\n  var _node$classList2;\n\n  for (var _len2 = arguments.length, classes = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    classes[_key2 - 1] = arguments[_key2];\n  }\n\n  node && classes.length > 0 && (_node$classList2 = node.classList).remove.apply(_node$classList2, classes);\n}\n\nvar Reason;\n\n(function (Reason) {\n  Reason[\"Finished\"] = \"finished\";\n  Reason[\"Cancelled\"] = \"cancelled\";\n})(Reason || (Reason = {}));\n\nfunction waitForTransition(node, done) {\n  var d = disposables();\n  if (!node) return d.dispose; // Safari returns a comma separated list of values, so let's sort them and take the highest value.\n\n  var _getComputedStyle = getComputedStyle(node),\n      transitionDuration = _getComputedStyle.transitionDuration,\n      transitionDelay = _getComputedStyle.transitionDelay;\n\n  var _map = [transitionDuration, transitionDelay].map(function (value) {\n    var _value$split$filter$m = value.split(',') // Remove falseys we can't work with\n    .filter(Boolean) // Values are returned as `0.3s` or `75ms`\n    .map(function (v) {\n      return v.includes('ms') ? parseFloat(v) : parseFloat(v) * 1000;\n    }).sort(function (a, z) {\n      return z - a;\n    }),\n        _value$split$filter$m2 = _value$split$filter$m[0],\n        resolvedValue = _value$split$filter$m2 === void 0 ? 0 : _value$split$filter$m2;\n\n    return resolvedValue;\n  }),\n      durationMs = _map[0],\n      delaysMs = _map[1]; // Waiting for the transition to end. We could use the `transitionend` event, however when no\n  // actual transition/duration is defined then the `transitionend` event is not fired.\n  //\n  // TODO: Downside is, when you slow down transitions via devtools this timeout is still using the\n  // full 100% speed instead of the 25% or 10%.\n\n\n  if (durationMs !== 0) {\n    d.setTimeout(function () {\n      done(Reason.Finished);\n    }, durationMs + delaysMs);\n  } else {\n    // No transition is happening, so we should cleanup already. Otherwise we have to wait until we\n    // get disposed.\n    done(Reason.Finished);\n  } // If we get disposed before the timeout runs we should cleanup anyway\n\n\n  d.add(function () {\n    return done(Reason.Cancelled);\n  });\n  return d.dispose;\n}\n\nfunction transition(node, base, from, to, done) {\n  var d = disposables();\n\n  var _done = done !== undefined ? once(done) : function () {};\n\n  addClasses.apply(void 0, [node].concat(base, from));\n  d.nextFrame(function () {\n    removeClasses.apply(void 0, [node].concat(from));\n    addClasses.apply(void 0, [node].concat(to));\n    d.add(waitForTransition(node, function (reason) {\n      removeClasses.apply(void 0, [node].concat(to, base));\n      return _done(reason);\n    }));\n  }); // Once we get disposed, we should ensure that we cleanup after ourselves. In case of an unmount,\n  // the node itself will be nullified and will be a no-op. In case of a full transition the classes\n  // are already removed which is also a no-op. However if you go from enter -> leave mid-transition\n  // then we have some leftovers that should be cleaned.\n\n  d.add(function () {\n    return removeClasses.apply(void 0, [node].concat(base, from, to));\n  }); // When we get disposed early, than we should also call the done method but switch the reason.\n\n  d.add(function () {\n    return _done(Reason.Cancelled);\n  });\n  return d.dispose;\n}\n\nfunction useSplitClasses(classes) {\n  if (classes === void 0) {\n    classes = '';\n  }\n\n  return useMemo(function () {\n    return classes.split(' ').filter(function (className) {\n      return className.trim().length > 1;\n    });\n  }, [classes]);\n}\n\nvar TransitionContext = /*#__PURE__*/createContext(null);\nvar TreeStates;\n\n(function (TreeStates) {\n  TreeStates[\"Visible\"] = \"visible\";\n  TreeStates[\"Hidden\"] = \"hidden\";\n})(TreeStates || (TreeStates = {}));\n\nfunction useTransitionContext() {\n  var context = useContext(TransitionContext);\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.');\n  }\n\n  return context;\n}\n\nfunction useParentNesting() {\n  var context = useContext(NestingContext);\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.');\n  }\n\n  return context;\n}\n\nvar NestingContext = /*#__PURE__*/createContext(null);\n\nfunction useNesting(done) {\n  var transitionableChildren = useRef([]);\n  var mounted = useIsMounted();\n  var unregister = useCallback(function (childId) {\n    var idx = transitionableChildren.current.indexOf(childId);\n    if (idx === -1) return;\n    transitionableChildren.current.splice(idx, 1);\n\n    if (transitionableChildren.current.length <= 0 && mounted.current) {\n      done === null || done === void 0 ? void 0 : done();\n    }\n  }, [done, mounted, transitionableChildren]);\n  var register = useCallback(function (childId) {\n    transitionableChildren.current.push(childId);\n    return function () {\n      return unregister(childId);\n    };\n  }, [transitionableChildren, unregister]);\n  return useMemo(function () {\n    return {\n      children: transitionableChildren,\n      register: register,\n      unregister: unregister\n    };\n  }, [register, unregister, transitionableChildren]);\n}\n\nfunction TransitionChild(props) {\n  var children = props.children,\n      enter = props.enter,\n      enterFrom = props.enterFrom,\n      enterTo = props.enterTo,\n      leave = props.leave,\n      leaveFrom = props.leaveFrom,\n      leaveTo = props.leaveTo,\n      rest = _objectWithoutPropertiesLoose(props, [\"children\", \"enter\", \"enterFrom\", \"enterTo\", \"leave\", \"leaveFrom\", \"leaveTo\"]);\n\n  var container = useRef(null);\n\n  var _React$useState = useState(TreeStates.Visible),\n      state = _React$useState[0],\n      setState = _React$useState[1];\n\n  var _useTransitionContext = useTransitionContext(),\n      show = _useTransitionContext.show,\n      appear = _useTransitionContext.appear;\n\n  var _useParentNesting = useParentNesting(),\n      register = _useParentNesting.register,\n      unregister = _useParentNesting.unregister;\n\n  var initial = useIsInitialRender();\n  var id = useId();\n  var isTransitioning = useRef(false);\n  var nesting = useNesting(useCallback(function () {\n    // When all children have been unmounted we can only hide ourselves if and only if we are not\n    // transitioning ourserlves. Otherwise we would unmount before the transitions are finished.\n    if (!isTransitioning.current) {\n      setState(TreeStates.Hidden);\n      unregister(id);\n    }\n  }, [id, unregister, isTransitioning]));\n  useIsoMorphicEffect(function () {\n    return register(id);\n  }, [register, id]);\n  var enterClasses = useSplitClasses(enter);\n  var enterFromClasses = useSplitClasses(enterFrom);\n  var enterToClasses = useSplitClasses(enterTo);\n  var leaveClasses = useSplitClasses(leave);\n  var leaveFromClasses = useSplitClasses(leaveFrom);\n  var leaveToClasses = useSplitClasses(leaveTo);\n  useEffect(function () {\n    if (state === TreeStates.Visible && container.current === null) {\n      throw new Error('Did you forget to passthrough the `ref` to the actual DOM node?');\n    }\n  }, [container, state]);\n  useIsoMorphicEffect(function () {\n    var node = container.current;\n    if (!node) return; // Skipping initial transition\n\n    if (initial && !appear) return;\n    isTransitioning.current = true;\n    return show ? transition(node, enterClasses, enterFromClasses, enterToClasses, function () {\n      isTransitioning.current = false;\n    }) : transition(node, leaveClasses, leaveFromClasses, leaveToClasses, function (reason) {\n      isTransitioning.current = false;\n      if (reason !== Reason.Finished) return; // When we don't have children anymore we can safely unregister from the parent and hide\n      // ourselves.\n\n      if (nesting.children.current.length <= 0) {\n        setState(TreeStates.Hidden);\n        unregister(id);\n      }\n    });\n  }, [id, isTransitioning, unregister, nesting, container, initial, appear, show, enterClasses, enterFromClasses, enterToClasses, leaveClasses, leaveFromClasses, leaveToClasses]); // Unmount the whole tree\n\n  if (state === TreeStates.Hidden) return null;\n\n  if (typeof children === 'function') {\n    return createElement(NestingContext.Provider, {\n      value: nesting\n    }, children(container));\n  }\n\n  var _rest$as = rest.as,\n      Component = _rest$as === void 0 ? 'div' : _rest$as,\n      passthroughProps = _objectWithoutPropertiesLoose(rest, [\"as\"]);\n\n  return createElement(NestingContext.Provider, {\n    value: nesting\n  }, createElement(Component, Object.assign({}, passthroughProps, {\n    ref: container\n  }), children));\n}\n\nfunction Transition(props) {\n  var _match;\n\n  var show = props.show,\n      _props$appear = props.appear,\n      appear = _props$appear === void 0 ? false : _props$appear,\n      rest = _objectWithoutPropertiesLoose(props, [\"show\", \"appear\"]);\n\n  if (![true, false].includes(show)) {\n    throw new Error('A <Transition /> is used but it is missing a `show={true | false}` prop.');\n  }\n\n  var _React$useState2 = useState(show ? TreeStates.Visible : TreeStates.Hidden),\n      state = _React$useState2[0],\n      setState = _React$useState2[1];\n\n  var nestingBag = useNesting(useCallback(function () {\n    setState(TreeStates.Hidden);\n  }, []));\n  var initial = useIsInitialRender();\n  var transitionBag = useMemo(function () {\n    return {\n      show: show,\n      appear: appear || !initial\n    };\n  }, [show, appear, initial]);\n  useEffect(function () {\n    if (show) {\n      setState(TreeStates.Visible);\n    } else if (nestingBag.children.current.length <= 0) {\n      setState(TreeStates.Hidden);\n    }\n  }, [show, nestingBag]);\n  return createElement(NestingContext.Provider, {\n    value: nestingBag\n  }, createElement(TransitionContext.Provider, {\n    value: transitionBag\n  }, match(state, (_match = {}, _match[TreeStates.Visible] = function () {\n    return createElement(TransitionChild, Object.assign({}, rest));\n  }, _match[TreeStates.Hidden] = null, _match))));\n}\n\nTransition.Child = TransitionChild;\n\nfunction render(props, bag, tag) {\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? tag : _props$as,\n      children = props.children,\n      passThroughProps = _objectWithoutPropertiesLoose(props, [\"as\", \"children\"]);\n\n  var resolvedChildren = typeof children === 'function' ? children(bag) : children;\n\n  if (Component === Fragment) {\n    if (Object.keys(passThroughProps).length > 0) {\n      if (Array.isArray(resolvedChildren) && resolvedChildren.length > 1) {\n        var err = new Error('You should only render 1 child');\n        if (Error.captureStackTrace) Error.captureStackTrace(err, render);\n        throw err;\n      }\n\n      if (!isValidElement(resolvedChildren)) {\n        var _err = new Error(\"You should render an element as a child. Did you forget the as=\\\"...\\\" prop?\");\n\n        if (Error.captureStackTrace) Error.captureStackTrace(_err, render);\n        throw _err;\n      }\n\n      return cloneElement(resolvedChildren, // Filter out undefined values so that they don't override the existing values\n      mergeEventFunctions(compact(passThroughProps), resolvedChildren.props, ['onClick']));\n    }\n  }\n\n  return createElement(Component, passThroughProps, resolvedChildren);\n}\n/**\r\n * We can use this function for the following useCase:\r\n *\r\n * <Menu.Item> <button onClick={console.log} /> </Menu.Item>\r\n *\r\n * Our `Menu.Item` will have an internal `onClick`, if you passthrough an `onClick` to the actual\r\n * `Menu.Item` component we will call it correctly. However, when we have an `onClick` on the actual\r\n * first child, that one should _also_ be called (but before this implementation, it was just\r\n * overriding the `onClick`). But it is only when we *render* that we have access to the existing\r\n * props of this component.\r\n *\r\n * It's a bit hacky, and not that clean, but it is something internal and we have tests to rely on\r\n * so that we can refactor this later (if needed).\r\n */\n\n\nfunction mergeEventFunctions(passThroughProps, existingProps, functionsToMerge) {\n  var clone = Object.assign({}, passThroughProps);\n\n  var _loop = function _loop() {\n    var func = _step.value;\n\n    if (passThroughProps[func] !== undefined && existingProps[func] !== undefined) {\n      var _Object$assign;\n\n      Object.assign(clone, (_Object$assign = {}, _Object$assign[func] = function (event) {\n        // Props we control\n        if (!event.defaultPrevented) passThroughProps[func](event); // Existing props on the component\n\n        if (!event.defaultPrevented) existingProps[func](event);\n      }, _Object$assign));\n    }\n  };\n\n  for (var _iterator = _createForOfIteratorHelperLoose(functionsToMerge), _step; !(_step = _iterator()).done;) {\n    _loop();\n  }\n\n  return clone;\n}\n/**\r\n * This is a hack, but basically we want to keep the full 'API' of the component, but we do want to\r\n * wrap it in a forwardRef so that we _can_ passthrough the ref\r\n */\n\n\nfunction forwardRefWithAs(component) {\n  return forwardRef(component);\n}\n\nfunction compact(object) {\n  var clone = Object.assign({}, object);\n\n  for (var key in clone) {\n    if (clone[key] === undefined) delete clone[key];\n  }\n\n  return clone;\n}\n\nfunction useDisposables() {\n  // Using useState instead of useRef so that we can use the initializer function.\n  var _React$useState = useState(disposables),\n      d = _React$useState[0];\n\n  useEffect(function () {\n    return function () {\n      return d.dispose();\n    };\n  }, [d]);\n  return d;\n}\n\nfunction useSyncRefs() {\n  for (var _len = arguments.length, refs = new Array(_len), _key = 0; _key < _len; _key++) {\n    refs[_key] = arguments[_key];\n  }\n\n  return useCallback(function (value) {\n    refs.forEach(function (ref) {\n      if (ref === null) return;\n      if (typeof ref === 'function') return ref(value);\n      ref.current = value;\n    });\n  }, [refs]);\n} // TODO: This must already exist somewhere, right? ðŸ¤”\n// Ref: https://www.w3.org/TR/uievents-key/#named-key-attribute-values\n\n\nvar Keys;\n\n(function (Keys) {\n  Keys[\"Space\"] = \" \";\n  Keys[\"Enter\"] = \"Enter\";\n  Keys[\"Escape\"] = \"Escape\";\n  Keys[\"Backspace\"] = \"Backspace\";\n  Keys[\"ArrowUp\"] = \"ArrowUp\";\n  Keys[\"ArrowDown\"] = \"ArrowDown\";\n  Keys[\"Home\"] = \"Home\";\n  Keys[\"End\"] = \"End\";\n  Keys[\"PageUp\"] = \"PageUp\";\n  Keys[\"PageDown\"] = \"PageDown\";\n  Keys[\"Tab\"] = \"Tab\";\n})(Keys || (Keys = {}));\n\nvar _reducers;\n\nvar MenuStates;\n\n(function (MenuStates) {\n  MenuStates[MenuStates[\"Open\"] = 0] = \"Open\";\n  MenuStates[MenuStates[\"Closed\"] = 1] = \"Closed\";\n})(MenuStates || (MenuStates = {}));\n\nvar ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"OpenMenu\"] = 0] = \"OpenMenu\";\n  ActionTypes[ActionTypes[\"CloseMenu\"] = 1] = \"CloseMenu\";\n  ActionTypes[ActionTypes[\"GoToItem\"] = 2] = \"GoToItem\";\n  ActionTypes[ActionTypes[\"Search\"] = 3] = \"Search\";\n  ActionTypes[ActionTypes[\"ClearSearch\"] = 4] = \"ClearSearch\";\n  ActionTypes[ActionTypes[\"RegisterItem\"] = 5] = \"RegisterItem\";\n  ActionTypes[ActionTypes[\"UnregisterItem\"] = 6] = \"UnregisterItem\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar Focus;\n\n(function (Focus) {\n  Focus[Focus[\"FirstItem\"] = 0] = \"FirstItem\";\n  Focus[Focus[\"PreviousItem\"] = 1] = \"PreviousItem\";\n  Focus[Focus[\"NextItem\"] = 2] = \"NextItem\";\n  Focus[Focus[\"LastItem\"] = 3] = \"LastItem\";\n  Focus[Focus[\"SpecificItem\"] = 4] = \"SpecificItem\";\n  Focus[Focus[\"Nothing\"] = 5] = \"Nothing\";\n})(Focus || (Focus = {}));\n\nfunction calculateActiveItemIndex(state, focus, id) {\n  var _state$activeItemInde, _match;\n\n  if (state.items.length <= 0) return null;\n  var items = state.items;\n  var activeItemIndex = (_state$activeItemInde = state.activeItemIndex) !== null && _state$activeItemInde !== void 0 ? _state$activeItemInde : -1;\n  var nextActiveIndex = match(focus, (_match = {}, _match[Focus.FirstItem] = function () {\n    return items.findIndex(function (item) {\n      return !item.dataRef.current.disabled;\n    });\n  }, _match[Focus.PreviousItem] = function () {\n    var idx = items.slice().reverse().findIndex(function (item, idx, all) {\n      if (activeItemIndex !== -1 && all.length - idx - 1 >= activeItemIndex) return false;\n      return !item.dataRef.current.disabled;\n    });\n    if (idx === -1) return idx;\n    return items.length - 1 - idx;\n  }, _match[Focus.NextItem] = function () {\n    return items.findIndex(function (item, idx) {\n      if (idx <= activeItemIndex) return false;\n      return !item.dataRef.current.disabled;\n    });\n  }, _match[Focus.LastItem] = function () {\n    var idx = items.slice().reverse().findIndex(function (item) {\n      return !item.dataRef.current.disabled;\n    });\n    if (idx === -1) return idx;\n    return items.length - 1 - idx;\n  }, _match[Focus.SpecificItem] = function () {\n    return items.findIndex(function (item) {\n      return item.id === id;\n    });\n  }, _match[Focus.Nothing] = function () {\n    return null;\n  }, _match));\n  if (nextActiveIndex === -1) return state.activeItemIndex;\n  return nextActiveIndex;\n}\n\nvar reducers = (_reducers = {}, _reducers[ActionTypes.CloseMenu] = function (state) {\n  return _extends({}, state, {\n    menuState: MenuStates.Closed\n  });\n}, _reducers[ActionTypes.OpenMenu] = function (state) {\n  return _extends({}, state, {\n    menuState: MenuStates.Open\n  });\n}, _reducers[ActionTypes.GoToItem] = function (state, action) {\n  var activeItemIndex = calculateActiveItemIndex(state, action.focus, action.id);\n\n  if (state.searchQuery === '' && state.activeItemIndex === activeItemIndex) {\n    return state;\n  }\n\n  return _extends({}, state, {\n    searchQuery: '',\n    activeItemIndex: activeItemIndex\n  });\n}, _reducers[ActionTypes.Search] = function (state, action) {\n  var searchQuery = state.searchQuery + action.value;\n  var match = state.items.findIndex(function (item) {\n    var _item$dataRef$current;\n\n    return ((_item$dataRef$current = item.dataRef.current.textValue) === null || _item$dataRef$current === void 0 ? void 0 : _item$dataRef$current.startsWith(searchQuery)) && !item.dataRef.current.disabled;\n  });\n\n  if (match === -1 || match === state.activeItemIndex) {\n    return _extends({}, state, {\n      searchQuery: searchQuery\n    });\n  }\n\n  return _extends({}, state, {\n    searchQuery: searchQuery,\n    activeItemIndex: match\n  });\n}, _reducers[ActionTypes.ClearSearch] = function (state) {\n  return _extends({}, state, {\n    searchQuery: ''\n  });\n}, _reducers[ActionTypes.RegisterItem] = function (state, action) {\n  return _extends({}, state, {\n    items: [].concat(state.items, [{\n      id: action.id,\n      dataRef: action.dataRef\n    }])\n  });\n}, _reducers[ActionTypes.UnregisterItem] = function (state, action) {\n  var nextItems = state.items.slice();\n  var currentActiveItem = state.activeItemIndex !== null ? nextItems[state.activeItemIndex] : null;\n  var idx = nextItems.findIndex(function (a) {\n    return a.id === action.id;\n  });\n  if (idx !== -1) nextItems.splice(idx, 1);\n  return _extends({}, state, {\n    items: nextItems,\n    activeItemIndex: function () {\n      if (idx === state.activeItemIndex) return null;\n      if (currentActiveItem === null) return null; // If we removed the item before the actual active index, then it would be out of sync. To\n      // fix this, we will find the correct (new) index position.\n\n      return nextItems.indexOf(currentActiveItem);\n    }()\n  });\n}, _reducers);\nvar MenuContext = /*#__PURE__*/createContext(null);\n\nfunction useMenuContext(component) {\n  var context = useContext(MenuContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Menu.name + \" /> component.\");\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(err, useMenuContext);\n    }\n\n    throw err;\n  }\n\n  return context;\n}\n\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\n\nvar DEFAULT_MENU_TAG = Fragment;\n\nfunction Menu(props) {\n  var d = useDisposables();\n  var reducerBag = useReducer(stateReducer, {\n    menuState: MenuStates.Closed,\n    buttonRef: createRef(),\n    itemsRef: createRef(),\n    items: [],\n    searchQuery: '',\n    activeItemIndex: null\n  });\n  var _reducerBag$ = reducerBag[0],\n      menuState = _reducerBag$.menuState,\n      itemsRef = _reducerBag$.itemsRef,\n      buttonRef = _reducerBag$.buttonRef,\n      dispatch = reducerBag[1];\n  useEffect(function () {\n    function handler(event) {\n      var _buttonRef$current, _itemsRef$current;\n\n      if (menuState !== MenuStates.Open) return;\n      if ((_buttonRef$current = buttonRef.current) === null || _buttonRef$current === void 0 ? void 0 : _buttonRef$current.contains(event.target)) return;\n\n      if (!((_itemsRef$current = itemsRef.current) === null || _itemsRef$current === void 0 ? void 0 : _itemsRef$current.contains(event.target))) {\n        var _buttonRef$current2;\n\n        dispatch({\n          type: ActionTypes.CloseMenu\n        });\n        if (!event.defaultPrevented) (_buttonRef$current2 = buttonRef.current) === null || _buttonRef$current2 === void 0 ? void 0 : _buttonRef$current2.focus();\n      }\n    }\n\n    window.addEventListener('click', handler);\n    return function () {\n      return window.removeEventListener('click', handler);\n    };\n  }, [menuState, itemsRef, buttonRef, d, dispatch]);\n  var propsBag = useMemo(function () {\n    return {\n      open: menuState === MenuStates.Open\n    };\n  }, [menuState]);\n  return createElement(MenuContext.Provider, {\n    value: reducerBag\n  }, render(props, propsBag, DEFAULT_MENU_TAG));\n}\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _state$itemsRef$curre5;\n\n  var _useMenuContext = useMenuContext([Menu.name, Button.name].join('.')),\n      state = _useMenuContext[0],\n      dispatch = _useMenuContext[1];\n\n  var buttonRef = useSyncRefs(state.buttonRef, ref);\n\n  var _React$useState = useState(false),\n      focused = _React$useState[0],\n      setFocused = _React$useState[1];\n\n  var id = \"headlessui-menu-button-\" + useId();\n  var d = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n      case Keys.Space:\n      case Keys.Enter:\n      case Keys.ArrowDown:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.OpenMenu\n        });\n        d.nextFrame(function () {\n          var _state$itemsRef$curre;\n\n          (_state$itemsRef$curre = state.itemsRef.current) === null || _state$itemsRef$curre === void 0 ? void 0 : _state$itemsRef$curre.focus();\n          dispatch({\n            type: ActionTypes.GoToItem,\n            focus: Focus.FirstItem\n          });\n        });\n        break;\n\n      case Keys.ArrowUp:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.OpenMenu\n        });\n        d.nextFrame(function () {\n          var _state$itemsRef$curre2;\n\n          (_state$itemsRef$curre2 = state.itemsRef.current) === null || _state$itemsRef$curre2 === void 0 ? void 0 : _state$itemsRef$curre2.focus();\n          dispatch({\n            type: ActionTypes.GoToItem,\n            focus: Focus.LastItem\n          });\n        });\n        break;\n    }\n  }, [dispatch, state, d]);\n  var handlePointerUp = useCallback(function (event) {\n    if (state.menuState === MenuStates.Open) {\n      dispatch({\n        type: ActionTypes.CloseMenu\n      });\n    } else {\n      event.preventDefault();\n      dispatch({\n        type: ActionTypes.OpenMenu\n      });\n      d.nextFrame(function () {\n        var _state$itemsRef$curre3;\n\n        return (_state$itemsRef$curre3 = state.itemsRef.current) === null || _state$itemsRef$curre3 === void 0 ? void 0 : _state$itemsRef$curre3.focus();\n      });\n    }\n  }, [dispatch, d, state]);\n  var handleFocus = useCallback(function () {\n    var _state$itemsRef$curre4;\n\n    if (state.menuState === MenuStates.Open) (_state$itemsRef$curre4 = state.itemsRef.current) === null || _state$itemsRef$curre4 === void 0 ? void 0 : _state$itemsRef$curre4.focus();\n    setFocused(true);\n  }, [state, setFocused]);\n  var handleBlur = useCallback(function () {\n    return setFocused(false);\n  }, [setFocused]);\n  var propsBag = useMemo(function () {\n    return {\n      open: state.menuState === MenuStates.Open,\n      focused: focused\n    };\n  }, [state, focused]);\n  var passthroughProps = props;\n  var propsWeControl = {\n    ref: buttonRef,\n    id: id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': (_state$itemsRef$curre5 = state.itemsRef.current) === null || _state$itemsRef$curre5 === void 0 ? void 0 : _state$itemsRef$curre5.id,\n    'aria-expanded': state.menuState === MenuStates.Open ? true : undefined,\n    onKeyDown: handleKeyDown,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    onPointerUp: handlePointerUp\n  };\n  return render(_extends({}, passthroughProps, propsWeControl), propsBag, DEFAULT_BUTTON_TAG);\n});\nvar DEFAULT_ITEMS_TAG = 'div';\nvar Items = /*#__PURE__*/forwardRefWithAs(function Items(props, ref) {\n  var _state$items$state$ac, _state$buttonRef$curr3;\n\n  var _props$static = props[\"static\"],\n      isStatic = _props$static === void 0 ? false : _props$static,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"static\"]);\n\n  var _useMenuContext2 = useMenuContext([Menu.name, Items.name].join('.')),\n      state = _useMenuContext2[0],\n      dispatch = _useMenuContext2[1];\n\n  var itemsRef = useSyncRefs(state.itemsRef, ref);\n  var id = \"headlessui-menu-items-\" + useId();\n  var d = useDisposables();\n  var searchDisposables = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    searchDisposables.dispose();\n\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n      // @ts-expect-error Fallthrough is expected here\n      case Keys.Space:\n        if (state.searchQuery !== '') {\n          event.preventDefault();\n          return dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n        }\n\n      // When in type ahead mode, fallthrough\n\n      case Keys.Enter:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.CloseMenu\n        });\n\n        if (state.activeItemIndex !== null) {\n          var _document$getElementB;\n\n          var _id = state.items[state.activeItemIndex].id;\n          (_document$getElementB = document.getElementById(_id)) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.click();\n          d.nextFrame(function () {\n            var _state$buttonRef$curr;\n\n            return (_state$buttonRef$curr = state.buttonRef.current) === null || _state$buttonRef$curr === void 0 ? void 0 : _state$buttonRef$curr.focus();\n          });\n        }\n\n        break;\n\n      case Keys.ArrowDown:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.NextItem\n        });\n\n      case Keys.ArrowUp:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.PreviousItem\n        });\n\n      case Keys.Home:\n      case Keys.PageUp:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.FirstItem\n        });\n\n      case Keys.End:\n      case Keys.PageDown:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.LastItem\n        });\n\n      case Keys.Escape:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.CloseMenu\n        });\n        d.nextFrame(function () {\n          var _state$buttonRef$curr2;\n\n          return (_state$buttonRef$curr2 = state.buttonRef.current) === null || _state$buttonRef$curr2 === void 0 ? void 0 : _state$buttonRef$curr2.focus();\n        });\n        break;\n\n      case Keys.Tab:\n        return event.preventDefault();\n\n      default:\n        if (event.key.length === 1) {\n          dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n          searchDisposables.setTimeout(function () {\n            return dispatch({\n              type: ActionTypes.ClearSearch\n            });\n          }, 350);\n        }\n\n        break;\n    }\n  }, [d, dispatch, searchDisposables, state]);\n  var propsBag = useMemo(function () {\n    return {\n      open: state.menuState === MenuStates.Open\n    };\n  }, [state]);\n  var propsWeControl = {\n    'aria-activedescendant': state.activeItemIndex === null ? undefined : (_state$items$state$ac = state.items[state.activeItemIndex]) === null || _state$items$state$ac === void 0 ? void 0 : _state$items$state$ac.id,\n    'aria-labelledby': (_state$buttonRef$curr3 = state.buttonRef.current) === null || _state$buttonRef$curr3 === void 0 ? void 0 : _state$buttonRef$curr3.id,\n    id: id,\n    onKeyDown: handleKeyDown,\n    role: 'menu',\n    tabIndex: 0\n  };\n  if (!isStatic && state.menuState === MenuStates.Closed) return null;\n  return render(_extends({}, passthroughProps, propsWeControl, {\n    ref: itemsRef\n  }), propsBag, DEFAULT_ITEMS_TAG);\n});\nvar DEFAULT_ITEM_TAG = Fragment;\n\nfunction Item(props) {\n  var _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      className = props.className,\n      onClick = props.onClick,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"disabled\", \"className\", \"onClick\"]);\n\n  var _useMenuContext3 = useMenuContext([Menu.name, Item.name].join('.')),\n      state = _useMenuContext3[0],\n      dispatch = _useMenuContext3[1];\n\n  var d = useDisposables();\n  var id = \"headlessui-menu-item-\" + useId();\n  var active = state.activeItemIndex !== null ? state.items[state.activeItemIndex].id === id : false;\n  var bag = useRef({\n    disabled: disabled\n  });\n  useIsoMorphicEffect(function () {\n    bag.current.disabled = disabled;\n  }, [bag, disabled]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB2, _document$getElementB3;\n\n    bag.current.textValue = (_document$getElementB2 = document.getElementById(id)) === null || _document$getElementB2 === void 0 ? void 0 : (_document$getElementB3 = _document$getElementB2.textContent) === null || _document$getElementB3 === void 0 ? void 0 : _document$getElementB3.toLowerCase();\n  }, [bag, id]);\n  useIsoMorphicEffect(function () {\n    dispatch({\n      type: ActionTypes.RegisterItem,\n      id: id,\n      dataRef: bag\n    });\n    return function () {\n      return dispatch({\n        type: ActionTypes.UnregisterItem,\n        id: id\n      });\n    };\n  }, [bag, id]);\n  var handleClick = useCallback(function (event) {\n    if (disabled) return event.preventDefault();\n    dispatch({\n      type: ActionTypes.CloseMenu\n    });\n    d.nextFrame(function () {\n      var _state$buttonRef$curr4;\n\n      return (_state$buttonRef$curr4 = state.buttonRef.current) === null || _state$buttonRef$curr4 === void 0 ? void 0 : _state$buttonRef$curr4.focus();\n    });\n    if (onClick) return onClick(event);\n  }, [d, dispatch, state.buttonRef, disabled, onClick]);\n  var handleFocus = useCallback(function () {\n    if (disabled) return dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Nothing\n    });\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.SpecificItem,\n      id: id\n    });\n  }, [disabled, id, dispatch]);\n  var handlePointerMove = useCallback(function () {\n    if (disabled) return;\n    if (active) return;\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.SpecificItem,\n      id: id\n    });\n  }, [disabled, active, id, dispatch]);\n  var handlePointerLeave = useCallback(function () {\n    if (disabled) return;\n    if (!active) return;\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Nothing\n    });\n  }, [disabled, active, dispatch]);\n  var propsBag = useMemo(function () {\n    return {\n      active: active,\n      disabled: disabled\n    };\n  }, [active, disabled]);\n  var propsWeControl = {\n    id: id,\n    role: 'menuitem',\n    tabIndex: -1,\n    className: resolvePropValue(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handlePointerMove,\n    onPointerLeave: handlePointerLeave\n  };\n  return render(_extends({}, passthroughProps, propsWeControl), propsBag, DEFAULT_ITEM_TAG);\n}\n\nfunction resolvePropValue(property, bag) {\n  if (property === undefined) return undefined;\n  if (typeof property === 'function') return property(bag);\n  return property;\n} // ---\n\n\nMenu.Button = Button;\nMenu.Items = Items;\nMenu.Item = Item;\n\nfunction useComputed(cb, dependencies) {\n  var _React$useState = useState(cb),\n      value = _React$useState[0],\n      setValue = _React$useState[1];\n\n  var cbRef = useRef(cb);\n  useIsoMorphicEffect(function () {\n    cbRef.current = cb;\n  }, [cb]);\n  useIsoMorphicEffect(function () {\n    return setValue(cbRef.current);\n  }, [cbRef, setValue].concat(dependencies));\n  return value;\n}\n\nvar _reducers$1;\n\nvar ListboxStates;\n\n(function (ListboxStates) {\n  ListboxStates[ListboxStates[\"Open\"] = 0] = \"Open\";\n  ListboxStates[ListboxStates[\"Closed\"] = 1] = \"Closed\";\n})(ListboxStates || (ListboxStates = {}));\n\nvar ActionTypes$1;\n\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"OpenListbox\"] = 0] = \"OpenListbox\";\n  ActionTypes[ActionTypes[\"CloseListbox\"] = 1] = \"CloseListbox\";\n  ActionTypes[ActionTypes[\"GoToOption\"] = 2] = \"GoToOption\";\n  ActionTypes[ActionTypes[\"Search\"] = 3] = \"Search\";\n  ActionTypes[ActionTypes[\"ClearSearch\"] = 4] = \"ClearSearch\";\n  ActionTypes[ActionTypes[\"RegisterOption\"] = 5] = \"RegisterOption\";\n  ActionTypes[ActionTypes[\"UnregisterOption\"] = 6] = \"UnregisterOption\";\n})(ActionTypes$1 || (ActionTypes$1 = {}));\n\nvar Focus$1;\n\n(function (Focus) {\n  Focus[Focus[\"First\"] = 0] = \"First\";\n  Focus[Focus[\"Previous\"] = 1] = \"Previous\";\n  Focus[Focus[\"Next\"] = 2] = \"Next\";\n  Focus[Focus[\"Last\"] = 3] = \"Last\";\n  Focus[Focus[\"Specific\"] = 4] = \"Specific\";\n  Focus[Focus[\"Nothing\"] = 5] = \"Nothing\";\n})(Focus$1 || (Focus$1 = {}));\n\nfunction calculateActiveOptionIndex(state, focus, id) {\n  var _state$activeOptionIn, _match;\n\n  if (state.options.length <= 0) return null;\n  var options = state.options;\n  var activeOptionIndex = (_state$activeOptionIn = state.activeOptionIndex) !== null && _state$activeOptionIn !== void 0 ? _state$activeOptionIn : -1;\n  var nextActiveIndex = match(focus, (_match = {}, _match[Focus$1.First] = function () {\n    return options.findIndex(function (option) {\n      return !option.dataRef.current.disabled;\n    });\n  }, _match[Focus$1.Previous] = function () {\n    var idx = options.slice().reverse().findIndex(function (option, idx, all) {\n      if (activeOptionIndex !== -1 && all.length - idx - 1 >= activeOptionIndex) return false;\n      return !option.dataRef.current.disabled;\n    });\n    if (idx === -1) return idx;\n    return options.length - 1 - idx;\n  }, _match[Focus$1.Next] = function () {\n    return options.findIndex(function (option, idx) {\n      if (idx <= activeOptionIndex) return false;\n      return !option.dataRef.current.disabled;\n    });\n  }, _match[Focus$1.Last] = function () {\n    var idx = options.slice().reverse().findIndex(function (option) {\n      return !option.dataRef.current.disabled;\n    });\n    if (idx === -1) return idx;\n    return options.length - 1 - idx;\n  }, _match[Focus$1.Specific] = function () {\n    return options.findIndex(function (option) {\n      return option.id === id;\n    });\n  }, _match[Focus$1.Nothing] = function () {\n    return null;\n  }, _match));\n  if (nextActiveIndex === -1) return state.activeOptionIndex;\n  return nextActiveIndex;\n}\n\nvar reducers$1 = (_reducers$1 = {}, _reducers$1[ActionTypes$1.CloseListbox] = function (state) {\n  return _extends({}, state, {\n    listboxState: ListboxStates.Closed\n  });\n}, _reducers$1[ActionTypes$1.OpenListbox] = function (state) {\n  return _extends({}, state, {\n    listboxState: ListboxStates.Open\n  });\n}, _reducers$1[ActionTypes$1.GoToOption] = function (state, action) {\n  var activeOptionIndex = calculateActiveOptionIndex(state, action.focus, action.id);\n\n  if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) {\n    return state;\n  }\n\n  return _extends({}, state, {\n    searchQuery: '',\n    activeOptionIndex: activeOptionIndex\n  });\n}, _reducers$1[ActionTypes$1.Search] = function (state, action) {\n  var searchQuery = state.searchQuery + action.value;\n  var match = state.options.findIndex(function (option) {\n    var _option$dataRef$curre;\n\n    return !option.dataRef.current.disabled && ((_option$dataRef$curre = option.dataRef.current.textValue) === null || _option$dataRef$curre === void 0 ? void 0 : _option$dataRef$curre.startsWith(searchQuery));\n  });\n\n  if (match === -1 || match === state.activeOptionIndex) {\n    return _extends({}, state, {\n      searchQuery: searchQuery\n    });\n  }\n\n  return _extends({}, state, {\n    searchQuery: searchQuery,\n    activeOptionIndex: match\n  });\n}, _reducers$1[ActionTypes$1.ClearSearch] = function (state) {\n  return _extends({}, state, {\n    searchQuery: ''\n  });\n}, _reducers$1[ActionTypes$1.RegisterOption] = function (state, action) {\n  return _extends({}, state, {\n    options: [].concat(state.options, [{\n      id: action.id,\n      dataRef: action.dataRef\n    }])\n  });\n}, _reducers$1[ActionTypes$1.UnregisterOption] = function (state, action) {\n  var nextOptions = state.options.slice();\n  var currentActiveOption = state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null;\n  var idx = nextOptions.findIndex(function (a) {\n    return a.id === action.id;\n  });\n  if (idx !== -1) nextOptions.splice(idx, 1);\n  return _extends({}, state, {\n    options: nextOptions,\n    activeOptionIndex: function () {\n      if (idx === state.activeOptionIndex) return null;\n      if (currentActiveOption === null) return null; // If we removed the option before the actual active index, then it would be out of sync. To\n      // fix this, we will find the correct (new) index position.\n\n      return nextOptions.indexOf(currentActiveOption);\n    }()\n  });\n}, _reducers$1);\nvar ListboxContext = /*#__PURE__*/createContext(null);\n\nfunction stateReducer$1(state, action) {\n  return match(action.type, reducers$1, state, action);\n}\n\nfunction useListboxContext(component) {\n  var context = useContext(ListboxContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Listbox.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext);\n    throw err;\n  }\n\n  return context;\n} // ---\n\n\nvar DEFAULT_LISTBOX_TAG = Fragment;\n\nfunction Listbox(props) {\n  var value = props.value,\n      onChange = props.onChange,\n      passThroughProps = _objectWithoutPropertiesLoose(props, [\"value\", \"onChange\"]);\n\n  var d = useDisposables();\n  var reducerBag = useReducer(stateReducer$1, {\n    listboxState: ListboxStates.Closed,\n    propsRef: {\n      current: {\n        value: value,\n        onChange: onChange\n      }\n    },\n    labelRef: createRef(),\n    buttonRef: createRef(),\n    optionsRef: createRef(),\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null\n  });\n  var _reducerBag$ = reducerBag[0],\n      listboxState = _reducerBag$.listboxState,\n      propsRef = _reducerBag$.propsRef,\n      optionsRef = _reducerBag$.optionsRef,\n      buttonRef = _reducerBag$.buttonRef,\n      dispatch = reducerBag[1];\n  useIsoMorphicEffect(function () {\n    propsRef.current.value = value;\n  }, [value, propsRef]);\n  useIsoMorphicEffect(function () {\n    propsRef.current.onChange = onChange;\n  }, [onChange, propsRef]);\n  useEffect(function () {\n    function handler(event) {\n      var _buttonRef$current, _optionsRef$current;\n\n      if (listboxState !== ListboxStates.Open) return;\n      if ((_buttonRef$current = buttonRef.current) === null || _buttonRef$current === void 0 ? void 0 : _buttonRef$current.contains(event.target)) return;\n\n      if (!((_optionsRef$current = optionsRef.current) === null || _optionsRef$current === void 0 ? void 0 : _optionsRef$current.contains(event.target))) {\n        var _buttonRef$current2;\n\n        dispatch({\n          type: ActionTypes$1.CloseListbox\n        });\n        if (!event.defaultPrevented) (_buttonRef$current2 = buttonRef.current) === null || _buttonRef$current2 === void 0 ? void 0 : _buttonRef$current2.focus();\n      }\n    }\n\n    window.addEventListener('click', handler);\n    return function () {\n      return window.removeEventListener('click', handler);\n    };\n  }, [listboxState, optionsRef, buttonRef, d, dispatch]);\n  var propsBag = useMemo(function () {\n    return {\n      open: listboxState === ListboxStates.Open\n    };\n  }, [listboxState]);\n  return createElement(ListboxContext.Provider, {\n    value: reducerBag\n  }, render(passThroughProps, propsBag, DEFAULT_LISTBOX_TAG));\n}\n\nvar DEFAULT_BUTTON_TAG$1 = 'button';\nvar Button$1 = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _state$optionsRef$cur5;\n\n  var _useListboxContext = useListboxContext([Listbox.name, Button.name].join('.')),\n      state = _useListboxContext[0],\n      dispatch = _useListboxContext[1];\n\n  var buttonRef = useSyncRefs(state.buttonRef, ref);\n\n  var _React$useState = useState(false),\n      focused = _React$useState[0],\n      setFocused = _React$useState[1];\n\n  var id = \"headlessui-listbox-button-\" + useId();\n  var d = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n      case Keys.Space:\n      case Keys.Enter:\n      case Keys.ArrowDown:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes$1.OpenListbox\n        });\n        d.nextFrame(function () {\n          var _state$optionsRef$cur;\n\n          (_state$optionsRef$cur = state.optionsRef.current) === null || _state$optionsRef$cur === void 0 ? void 0 : _state$optionsRef$cur.focus();\n          if (!state.propsRef.current.value) dispatch({\n            type: ActionTypes$1.GoToOption,\n            focus: Focus$1.First\n          });\n        });\n        break;\n\n      case Keys.ArrowUp:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes$1.OpenListbox\n        });\n        d.nextFrame(function () {\n          var _state$optionsRef$cur2;\n\n          (_state$optionsRef$cur2 = state.optionsRef.current) === null || _state$optionsRef$cur2 === void 0 ? void 0 : _state$optionsRef$cur2.focus();\n          if (!state.propsRef.current.value) dispatch({\n            type: ActionTypes$1.GoToOption,\n            focus: Focus$1.Last\n          });\n        });\n        break;\n    }\n  }, [dispatch, state, d]);\n  var handlePointerUp = useCallback(function (event) {\n    if (state.listboxState === ListboxStates.Open) {\n      dispatch({\n        type: ActionTypes$1.CloseListbox\n      });\n    } else {\n      event.preventDefault();\n      dispatch({\n        type: ActionTypes$1.OpenListbox\n      });\n      d.nextFrame(function () {\n        var _state$optionsRef$cur3;\n\n        return (_state$optionsRef$cur3 = state.optionsRef.current) === null || _state$optionsRef$cur3 === void 0 ? void 0 : _state$optionsRef$cur3.focus();\n      });\n    }\n  }, [dispatch, d, state]);\n  var handleFocus = useCallback(function () {\n    var _state$optionsRef$cur4;\n\n    if (state.listboxState === ListboxStates.Open) return (_state$optionsRef$cur4 = state.optionsRef.current) === null || _state$optionsRef$cur4 === void 0 ? void 0 : _state$optionsRef$cur4.focus();\n    setFocused(true);\n  }, [state, setFocused]);\n  var handleBlur = useCallback(function () {\n    return setFocused(false);\n  }, [setFocused]);\n  var labelledby = useComputed(function () {\n    if (!state.labelRef.current) return undefined;\n    return [state.labelRef.current.id, id].join(' ');\n  }, [state.labelRef.current, id]);\n  var propsBag = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open,\n      focused: focused\n    };\n  }, [state, focused]);\n  var passthroughProps = props;\n  var propsWeControl = {\n    ref: buttonRef,\n    id: id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': (_state$optionsRef$cur5 = state.optionsRef.current) === null || _state$optionsRef$cur5 === void 0 ? void 0 : _state$optionsRef$cur5.id,\n    'aria-expanded': state.listboxState === ListboxStates.Open ? true : undefined,\n    'aria-labelledby': labelledby,\n    onKeyDown: handleKeyDown,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    onPointerUp: handlePointerUp\n  };\n  return render(_extends({}, passthroughProps, propsWeControl), propsBag, DEFAULT_BUTTON_TAG$1);\n});\nvar DEFAULT_LABEL_TAG = 'label';\n\nfunction Label(props) {\n  var _useListboxContext2 = useListboxContext([Listbox.name, Label.name].join('.')),\n      state = _useListboxContext2[0];\n\n  var id = \"headlessui-listbox-label-\" + useId();\n  var handlePointerUp = useCallback(function () {\n    var _state$buttonRef$curr;\n\n    return (_state$buttonRef$curr = state.buttonRef.current) === null || _state$buttonRef$curr === void 0 ? void 0 : _state$buttonRef$curr.focus();\n  }, [state.buttonRef]);\n  var propsBag = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open\n    };\n  }, [state]);\n  var propsWeControl = {\n    ref: state.labelRef,\n    id: id,\n    onPointerUp: handlePointerUp\n  };\n  return render(_extends({}, props, propsWeControl), propsBag, DEFAULT_LABEL_TAG);\n}\n\nvar DEFAULT_OPTIONS_TAG = 'ul';\nvar Options = /*#__PURE__*/forwardRefWithAs(function Options(props, ref) {\n  var _state$options$state$;\n\n  var _props$static = props[\"static\"],\n      isStatic = _props$static === void 0 ? false : _props$static,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"enter\", \"enterFrom\", \"enterTo\", \"leave\", \"leaveFrom\", \"leaveTo\", \"static\"]);\n\n  var _useListboxContext3 = useListboxContext([Listbox.name, Options.name].join('.')),\n      state = _useListboxContext3[0],\n      dispatch = _useListboxContext3[1];\n\n  var optionsRef = useSyncRefs(state.optionsRef, ref);\n  var id = \"headlessui-listbox-options-\" + useId();\n  var d = useDisposables();\n  var searchDisposables = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    searchDisposables.dispose();\n\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n      // @ts-expect-error Fallthrough is expected here\n      case Keys.Space:\n        if (state.searchQuery !== '') {\n          event.preventDefault();\n          return dispatch({\n            type: ActionTypes$1.Search,\n            value: event.key\n          });\n        }\n\n      // When in type ahead mode, fallthrough\n\n      case Keys.Enter:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes$1.CloseListbox\n        });\n\n        if (state.activeOptionIndex !== null) {\n          var dataRef = state.options[state.activeOptionIndex].dataRef;\n          state.propsRef.current.onChange(dataRef.current.value);\n        }\n\n        d.nextFrame(function () {\n          var _state$buttonRef$curr2;\n\n          return (_state$buttonRef$curr2 = state.buttonRef.current) === null || _state$buttonRef$curr2 === void 0 ? void 0 : _state$buttonRef$curr2.focus();\n        });\n        break;\n\n      case Keys.ArrowDown:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes$1.GoToOption,\n          focus: Focus$1.Next\n        });\n\n      case Keys.ArrowUp:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes$1.GoToOption,\n          focus: Focus$1.Previous\n        });\n\n      case Keys.Home:\n      case Keys.PageUp:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes$1.GoToOption,\n          focus: Focus$1.First\n        });\n\n      case Keys.End:\n      case Keys.PageDown:\n        event.preventDefault();\n        return dispatch({\n          type: ActionTypes$1.GoToOption,\n          focus: Focus$1.Last\n        });\n\n      case Keys.Escape:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes$1.CloseListbox\n        });\n        return d.nextFrame(function () {\n          var _state$buttonRef$curr3;\n\n          return (_state$buttonRef$curr3 = state.buttonRef.current) === null || _state$buttonRef$curr3 === void 0 ? void 0 : _state$buttonRef$curr3.focus();\n        });\n\n      case Keys.Tab:\n        return event.preventDefault();\n\n      default:\n        if (event.key.length === 1) {\n          dispatch({\n            type: ActionTypes$1.Search,\n            value: event.key\n          });\n          searchDisposables.setTimeout(function () {\n            return dispatch({\n              type: ActionTypes$1.ClearSearch\n            });\n          }, 350);\n        }\n\n        break;\n    }\n  }, [d, dispatch, searchDisposables, state]);\n  var labelledby = useComputed(function () {\n    var _state$labelRef$curre, _state$labelRef$curre2, _state$buttonRef$curr4;\n\n    return (_state$labelRef$curre = (_state$labelRef$curre2 = state.labelRef.current) === null || _state$labelRef$curre2 === void 0 ? void 0 : _state$labelRef$curre2.id) !== null && _state$labelRef$curre !== void 0 ? _state$labelRef$curre : (_state$buttonRef$curr4 = state.buttonRef.current) === null || _state$buttonRef$curr4 === void 0 ? void 0 : _state$buttonRef$curr4.id;\n  }, [state.labelRef.current, state.buttonRef.current]);\n  var propsBag = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open\n    };\n  }, [state]);\n  var propsWeControl = {\n    'aria-activedescendant': state.activeOptionIndex === null ? undefined : (_state$options$state$ = state.options[state.activeOptionIndex]) === null || _state$options$state$ === void 0 ? void 0 : _state$options$state$.id,\n    'aria-labelledby': labelledby,\n    id: id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0\n  };\n  if (!isStatic && state.listboxState === ListboxStates.Closed) return null;\n  return render(_extends({}, passthroughProps, propsWeControl, {\n    ref: optionsRef\n  }), propsBag, DEFAULT_OPTIONS_TAG);\n});\nvar DEFAULT_OPTION_TAG = 'li';\n\nfunction Option(props) {\n  var _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      value = props.value,\n      className = props.className,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"disabled\", \"value\", \"className\"]);\n\n  var _useListboxContext4 = useListboxContext([Listbox.name, Option.name].join('.')),\n      state = _useListboxContext4[0],\n      dispatch = _useListboxContext4[1];\n\n  var d = useDisposables();\n  var id = \"headlessui-listbox-option-\" + useId();\n  var active = state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false;\n  var selected = state.propsRef.current.value === value;\n  var bag = useRef({\n    disabled: disabled,\n    value: value\n  });\n  useIsoMorphicEffect(function () {\n    bag.current.disabled = disabled;\n  }, [bag, disabled]);\n  useIsoMorphicEffect(function () {\n    bag.current.value = value;\n  }, [bag, value]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB, _document$getElementB2;\n\n    bag.current.textValue = (_document$getElementB = document.getElementById(id)) === null || _document$getElementB === void 0 ? void 0 : (_document$getElementB2 = _document$getElementB.textContent) === null || _document$getElementB2 === void 0 ? void 0 : _document$getElementB2.toLowerCase();\n  }, [bag, id]);\n  var select = useCallback(function () {\n    return state.propsRef.current.onChange(value);\n  }, [state.propsRef, value]);\n  useIsoMorphicEffect(function () {\n    dispatch({\n      type: ActionTypes$1.RegisterOption,\n      id: id,\n      dataRef: bag\n    });\n    return function () {\n      return dispatch({\n        type: ActionTypes$1.UnregisterOption,\n        id: id\n      });\n    };\n  }, [bag, id]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB3, _document$getElementB4;\n\n    if (!selected) return;\n    dispatch({\n      type: ActionTypes$1.GoToOption,\n      focus: Focus$1.Specific,\n      id: id\n    });\n    (_document$getElementB3 = document.getElementById(id)) === null || _document$getElementB3 === void 0 ? void 0 : (_document$getElementB4 = _document$getElementB3.focus) === null || _document$getElementB4 === void 0 ? void 0 : _document$getElementB4.call(_document$getElementB3);\n  }, []);\n  useIsoMorphicEffect(function () {\n    if (!active) return;\n    var d = disposables();\n    d.nextFrame(function () {\n      var _document$getElementB5, _document$getElementB6;\n\n      return (_document$getElementB5 = document.getElementById(id)) === null || _document$getElementB5 === void 0 ? void 0 : (_document$getElementB6 = _document$getElementB5.scrollIntoView) === null || _document$getElementB6 === void 0 ? void 0 : _document$getElementB6.call(_document$getElementB5, {\n        block: 'nearest'\n      });\n    });\n    return d.dispose;\n  }, [active]);\n  var handleClick = useCallback(function (event) {\n    if (disabled) return event.preventDefault();\n    select();\n    dispatch({\n      type: ActionTypes$1.CloseListbox\n    });\n    d.nextFrame(function () {\n      var _state$buttonRef$curr5;\n\n      return (_state$buttonRef$curr5 = state.buttonRef.current) === null || _state$buttonRef$curr5 === void 0 ? void 0 : _state$buttonRef$curr5.focus();\n    });\n  }, [d, dispatch, state.buttonRef, disabled, select]);\n  var handleFocus = useCallback(function () {\n    if (disabled) return dispatch({\n      type: ActionTypes$1.GoToOption,\n      focus: Focus$1.Nothing\n    });\n    dispatch({\n      type: ActionTypes$1.GoToOption,\n      focus: Focus$1.Specific,\n      id: id\n    });\n  }, [disabled, id, dispatch]);\n  var handlePointerMove = useCallback(function () {\n    if (disabled) return;\n    if (active) return;\n    dispatch({\n      type: ActionTypes$1.GoToOption,\n      focus: Focus$1.Specific,\n      id: id\n    });\n  }, [disabled, active, id, dispatch]);\n  var handlePointerLeave = useCallback(function () {\n    if (disabled) return;\n    if (!active) return;\n    dispatch({\n      type: ActionTypes$1.GoToOption,\n      focus: Focus$1.Nothing\n    });\n  }, [disabled, active, dispatch]);\n  var propsBag = useMemo(function () {\n    return {\n      active: active,\n      selected: selected,\n      disabled: disabled\n    };\n  }, [active, selected, disabled]);\n  var propsWeControl = {\n    id: id,\n    role: 'option',\n    tabIndex: -1,\n    className: resolvePropValue$1(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handlePointerMove,\n    onPointerLeave: handlePointerLeave\n  };\n  return render(_extends({}, passthroughProps, propsWeControl), propsBag, DEFAULT_OPTION_TAG);\n}\n\nfunction resolvePropValue$1(property, bag) {\n  if (property === undefined) return undefined;\n  if (typeof property === 'function') return property(bag);\n  return property;\n} // ---\n\n\nListbox.Button = Button$1;\nListbox.Label = Label;\nListbox.Options = Options;\nListbox.Option = Option;\nvar GroupContext = /*#__PURE__*/createContext(null);\n\nfunction useGroupContext(component) {\n  var context = useContext(GroupContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <Switch.Group /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useGroupContext);\n    throw err;\n  }\n\n  return context;\n} // ---\n\n\nvar DEFAULT_GROUP_TAG = Fragment;\n\nfunction Group(props) {\n  var _React$useState = useState(null),\n      switchElement = _React$useState[0],\n      setSwitchElement = _React$useState[1];\n\n  var _React$useState2 = useState(null),\n      labelElement = _React$useState2[0],\n      setLabelElement = _React$useState2[1];\n\n  var context = useMemo(function () {\n    return {\n      \"switch\": switchElement,\n      label: labelElement,\n      setSwitch: setSwitchElement,\n      setLabel: setLabelElement\n    };\n  }, [switchElement, setSwitchElement, labelElement, setLabelElement]);\n  return createElement(GroupContext.Provider, {\n    value: context\n  }, render(props, {}, DEFAULT_GROUP_TAG));\n} // ---\n\n\nvar DEFAULT_SWITCH_TAG = 'button';\n\nfunction Switch(props) {\n  var _groupContext$label;\n\n  var checked = props.checked,\n      onChange = props.onChange,\n      className = props.className,\n      passThroughProps = _objectWithoutPropertiesLoose(props, [\"checked\", \"onChange\", \"className\"]);\n\n  var id = \"headlessui-switch-\" + useId();\n  var groupContext = useContext(GroupContext);\n  var toggle = useCallback(function () {\n    return onChange(!checked);\n  }, [onChange, checked]);\n  var handleClick = useCallback(function (event) {\n    event.preventDefault();\n    toggle();\n  }, [toggle]);\n  var handleKeyDown = useCallback(function (event) {\n    event.preventDefault();\n    if (event.key === Keys.Space) toggle();\n  }, [toggle]);\n  var propsBag = useMemo(function () {\n    return {\n      checked: checked\n    };\n  }, [checked]);\n  var propsWeControl = {\n    id: id,\n    ref: groupContext === null ? undefined : groupContext.setSwitch,\n    role: 'switch',\n    tabIndex: 0,\n    className: resolvePropValue$2(className, propsBag),\n    'aria-checked': checked,\n    'aria-labelledby': groupContext === null || groupContext === void 0 ? void 0 : (_groupContext$label = groupContext.label) === null || _groupContext$label === void 0 ? void 0 : _groupContext$label.id,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown\n  };\n  return render(_extends({}, passThroughProps, propsWeControl), propsBag, DEFAULT_SWITCH_TAG);\n}\n\nvar DEFAULT_LABEL_TAG$1 = 'label';\n\nfunction Label$1(props) {\n  var state = useGroupContext([Switch.name, Label$1.name].join('.'));\n  var id = \"headlessui-switch-label-\" + useId();\n  var handlePointerUp = useCallback(function () {\n    if (!state[\"switch\"]) return;\n    state[\"switch\"].click();\n    state[\"switch\"].focus();\n  }, [state[\"switch\"]]);\n  var propsWeControl = {\n    ref: state.setLabel,\n    id: id,\n    onPointerUp: handlePointerUp\n  };\n  return render(_extends({}, props, propsWeControl), {}, DEFAULT_LABEL_TAG$1);\n} // ---\n\n\nSwitch.Group = Group;\nSwitch.Label = Label$1; // ---\n\nfunction resolvePropValue$2(property, bag) {\n  if (property === undefined) return undefined;\n  if (typeof property === 'function') return property(bag);\n  return property;\n}\n\nexport { Listbox, Menu, Switch, Transition };","map":{"version":3,"sources":["../src/hooks/use-iso-morphic-effect.ts","../src/hooks/use-id.ts","../src/hooks/use-is-initial-render.ts","../src/hooks/use-is-mounted.ts","../src/utils/match.ts","../src/utils/once.ts","../src/utils/disposables.ts","../src/components/transitions/utils/transition.ts","../src/components/transitions/transition.tsx","../src/utils/render.ts","../src/hooks/use-disposables.ts","../src/hooks/use-sync-refs.ts","../src/components/keyboard.ts","../src/components/menu/menu.tsx","../src/hooks/use-computed.ts","../src/components/listbox/listbox.tsx","../src/components/switch/switch.tsx"],"names":["useIsoMorphicEffect","state","serverHandoffComplete","id","useId","setId","React","generateId","useIsInitialRender","initial","useIsMounted","mounted","match","value","lookup","args","returnValue","error","Error","once","cb","called","disposables","api","requestAnimationFrame","raf","cancelAnimationFrame","nextFrame","setTimeout","timer","clearTimeout","add","dispose","classes","node","Reason","d","transitionDuration","transitionDelay","getComputedStyle","durationMs","delaysMs","resolvedValue","v","parseFloat","z","done","transition","base","from","to","_done","addClasses","removeClasses","waitForTransition","className","TransitionContext","TreeStates","context","NestingContext","transitionableChildren","unregister","idx","register","children","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","rest","props","container","setState","show","appear","useTransitionContext","useParentNesting","isTransitioning","nesting","useNesting","enterClasses","useSplitClasses","enterFromClasses","enterToClasses","leaveClasses","leaveFromClasses","leaveToClasses","reason","as","Component","passthroughProps","ref","Transition","nestingBag","transitionBag","render","bag","tag","passThroughProps","resolvedChildren","Object","Array","err","mergeEventFunctions","compact","clone","func","existingProps","event","forwardRefWithAs","component","useDisposables","useSyncRefs","refs","Keys","MenuStates","ActionTypes","Focus","items","activeItemIndex","nextActiveIndex","item","all","reducers","menuState","Closed","Open","calculateActiveItemIndex","action","searchQuery","dataRef","nextItems","currentActiveItem","a","MenuContext","Menu","DEFAULT_MENU_TAG","reducerBag","buttonRef","itemsRef","dispatch","type","CloseMenu","window","propsBag","open","DEFAULT_BUTTON_TAG","Button","useMenuContext","focused","setFocused","handleKeyDown","OpenMenu","focus","FirstItem","LastItem","handlePointerUp","handleFocus","handleBlur","propsWeControl","onKeyDown","onFocus","onBlur","onPointerUp","DEFAULT_ITEMS_TAG","Items","isStatic","searchDisposables","key","NextItem","PreviousItem","ClearSearch","role","tabIndex","DEFAULT_ITEM_TAG","disabled","onClick","Item","active","document","handleClick","Nothing","handlePointerMove","handlePointerLeave","resolvePropValue","onPointerMove","onPointerLeave","property","useComputed","dependencies","setValue","cbRef","ListboxStates","options","activeOptionIndex","option","listboxState","calculateActiveOptionIndex","nextOptions","currentActiveOption","ListboxContext","Listbox","DEFAULT_LISTBOX_TAG","onChange","propsRef","current","labelRef","optionsRef","CloseListbox","useListboxContext","OpenListbox","First","Last","labelledby","DEFAULT_LABEL_TAG","Label","DEFAULT_OPTIONS_TAG","Options","Next","Previous","DEFAULT_OPTION_TAG","Option","selected","select","block","GroupContext","DEFAULT_GROUP_TAG","switchElement","setSwitchElement","labelElement","setLabelElement","label","setSwitch","setLabel","DEFAULT_SWITCH_TAG","Switch","checked","groupContext","toggle","useGroupContext"],"mappings":"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","sourcesContent":["import * as React from 'react'\n\nexport const useIsoMorphicEffect =\n  typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect\n","import * as React from 'react'\nimport { useIsoMorphicEffect } from './use-iso-morphic-effect'\n\n// We used a \"simple\" approach first which worked for SSR and rehydration on the client. However we\n// didn't take care of the Suspense case. To fix this we used the approach the @reach-ui/auto-id\n// uses.\n//\n// Credits: https://github.com/reach/reach-ui/blob/develop/packages/auto-id/src/index.tsx\n\nlet state = { serverHandoffComplete: false }\nlet id = 0\nfunction generateId() {\n  return ++id\n}\n\nexport function useId() {\n  const [id, setId] = React.useState(state.serverHandoffComplete ? generateId : null)\n\n  useIsoMorphicEffect(() => {\n    if (id === null) setId(generateId())\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  React.useEffect(() => {\n    if (state.serverHandoffComplete === false) state.serverHandoffComplete = true\n  }, [])\n\n  return id != null ? '' + id : undefined\n}\n","import * as React from 'react'\n\nexport function useIsInitialRender() {\n  const initial = React.useRef(true)\n\n  React.useEffect(() => {\n    initial.current = false\n  }, [])\n\n  return initial.current\n}\n","import * as React from 'react'\n\nexport function useIsMounted() {\n  const mounted = React.useRef(true)\n\n  React.useEffect(() => {\n    return () => {\n      mounted.current = false\n    }\n  }, [])\n\n  return mounted\n}\n","export function match<TValue extends string | number = string, TReturnValue = unknown>(\n  value: TValue,\n  lookup: Record<TValue, TReturnValue | ((...args: any[]) => TReturnValue)>,\n  ...args: any[]\n): TReturnValue {\n  if (value in lookup) {\n    const returnValue = lookup[value]\n    return typeof returnValue === 'function' ? returnValue(...args) : returnValue\n  }\n\n  const error = new Error(\n    `Tried to handle \"${value}\" but there is no handler defined. Only defined handlers are: ${Object.keys(\n      lookup\n    )\n      .map(key => `\"${key}\"`)\n      .join(', ')}.`\n  )\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(error, match)\n  }\n\n  throw error\n}\n","export function once<T>(cb: (...args: T[]) => void) {\n  const state = { called: false }\n\n  return (...args: T[]) => {\n    if (state.called) {\n      return\n    }\n    state.called = true\n    return cb(...args)\n  }\n}\n","export function disposables() {\n  const disposables: Function[] = []\n\n  const api = {\n    requestAnimationFrame(...args: Parameters<typeof requestAnimationFrame>) {\n      const raf = requestAnimationFrame(...args)\n      api.add(() => cancelAnimationFrame(raf))\n    },\n\n    nextFrame(...args: Parameters<typeof requestAnimationFrame>) {\n      api.requestAnimationFrame(() => {\n        api.requestAnimationFrame(...args)\n      })\n    },\n\n    setTimeout(...args: Parameters<typeof setTimeout>) {\n      const timer = setTimeout(...args)\n      api.add(() => clearTimeout(timer))\n    },\n\n    add(cb: () => void) {\n      disposables.push(cb)\n    },\n\n    dispose() {\n      disposables.splice(0).forEach(dispose => dispose())\n    },\n  }\n\n  return api\n}\n","import { once } from '../../../utils/once'\nimport { disposables } from '../../../utils/disposables'\n\nfunction addClasses(node: HTMLElement, ...classes: string[]) {\n  node && classes.length > 0 && node.classList.add(...classes)\n}\n\nfunction removeClasses(node: HTMLElement, ...classes: string[]) {\n  node && classes.length > 0 && node.classList.remove(...classes)\n}\n\nexport enum Reason {\n  Finished = 'finished',\n  Cancelled = 'cancelled',\n}\n\nfunction waitForTransition(node: HTMLElement, done: (reason: Reason) => void) {\n  const d = disposables()\n\n  if (!node) return d.dispose\n\n  // Safari returns a comma separated list of values, so let's sort them and take the highest value.\n  const { transitionDuration, transitionDelay } = getComputedStyle(node)\n\n  const [durationMs, delaysMs] = [transitionDuration, transitionDelay].map(value => {\n    const [resolvedValue = 0] = value\n      .split(',')\n      // Remove falseys we can't work with\n      .filter(Boolean)\n      // Values are returned as `0.3s` or `75ms`\n      .map(v => (v.includes('ms') ? parseFloat(v) : parseFloat(v) * 1000))\n      .sort((a, z) => z - a)\n\n    return resolvedValue\n  })\n\n  // Waiting for the transition to end. We could use the `transitionend` event, however when no\n  // actual transition/duration is defined then the `transitionend` event is not fired.\n  //\n  // TODO: Downside is, when you slow down transitions via devtools this timeout is still using the\n  // full 100% speed instead of the 25% or 10%.\n  if (durationMs !== 0) {\n    d.setTimeout(() => {\n      done(Reason.Finished)\n    }, durationMs + delaysMs)\n  } else {\n    // No transition is happening, so we should cleanup already. Otherwise we have to wait until we\n    // get disposed.\n    done(Reason.Finished)\n  }\n\n  // If we get disposed before the timeout runs we should cleanup anyway\n  d.add(() => done(Reason.Cancelled))\n\n  return d.dispose\n}\n\nexport function transition(\n  node: HTMLElement,\n  base: string[],\n  from: string[],\n  to: string[],\n  done?: (reason: Reason) => void\n) {\n  const d = disposables()\n  const _done = done !== undefined ? once(done) : () => {}\n\n  addClasses(node, ...base, ...from)\n\n  d.nextFrame(() => {\n    removeClasses(node, ...from)\n    addClasses(node, ...to)\n\n    d.add(\n      waitForTransition(node, reason => {\n        removeClasses(node, ...to, ...base)\n        return _done(reason)\n      })\n    )\n  })\n\n  // Once we get disposed, we should ensure that we cleanup after ourselves. In case of an unmount,\n  // the node itself will be nullified and will be a no-op. In case of a full transition the classes\n  // are already removed which is also a no-op. However if you go from enter -> leave mid-transition\n  // then we have some leftovers that should be cleaned.\n  d.add(() => removeClasses(node, ...base, ...from, ...to))\n\n  // When we get disposed early, than we should also call the done method but switch the reason.\n  d.add(() => _done(Reason.Cancelled))\n\n  return d.dispose\n}\n","import * as React from 'react'\n\nimport { useId } from '../../hooks/use-id'\nimport { useIsInitialRender } from '../../hooks/use-is-initial-render'\nimport { useIsMounted } from '../../hooks/use-is-mounted'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\n\nimport { match } from '../../utils/match'\nimport { Reason, transition } from './utils/transition'\n\ntype ID = ReturnType<typeof useId>\n\nfunction useSplitClasses(classes: string = '') {\n  return React.useMemo(() => classes.split(' ').filter(className => className.trim().length > 1), [\n    classes,\n  ])\n}\n\ntype TransitionContextValues = {\n  show: boolean\n  appear: boolean\n} | null\nconst TransitionContext = React.createContext<TransitionContextValues>(null)\n\nenum TreeStates {\n  Visible = 'visible',\n  Hidden = 'hidden',\n}\n\nexport type TransitionClasses = Partial<{\n  enter: string\n  enterFrom: string\n  enterTo: string\n  leave: string\n  leaveFrom: string\n  leaveTo: string\n}>\n\ntype HTMLTags = keyof JSX.IntrinsicElements\ntype HTMLTagProps<TTag extends HTMLTags> = JSX.IntrinsicElements[TTag]\n\ntype AsShortcut<TTag extends HTMLTags> = {\n  children?: React.ReactNode\n  as?: TTag\n} & Omit<HTMLTagProps<TTag>, 'ref'>\n\ntype AsRenderPropFunction = {\n  children: (ref: React.MutableRefObject<any>) => JSX.Element\n}\n\ntype BaseConfig = Partial<{ appear: boolean }>\n\ntype TransitionChildProps<TTag extends HTMLTags> = BaseConfig &\n  (AsShortcut<TTag> | AsRenderPropFunction) &\n  TransitionClasses\n\nfunction useTransitionContext() {\n  const context = React.useContext(TransitionContext)\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.')\n  }\n\n  return context\n}\n\nfunction useParentNesting() {\n  const context = React.useContext(NestingContext)\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.')\n  }\n\n  return context\n}\n\ntype NestingContextValues = {\n  children: React.MutableRefObject<ID[]>\n  register: (id: ID) => () => void\n  unregister: (id: ID) => void\n}\n\nconst NestingContext = React.createContext<NestingContextValues | null>(null)\n\nfunction useNesting(done?: () => void) {\n  const transitionableChildren = React.useRef<ID[]>([])\n  const mounted = useIsMounted()\n\n  const unregister = React.useCallback(\n    (childId: ID) => {\n      const idx = transitionableChildren.current.indexOf(childId)\n\n      if (idx === -1) return\n\n      transitionableChildren.current.splice(idx, 1)\n\n      if (transitionableChildren.current.length <= 0 && mounted.current) {\n        done?.()\n      }\n    },\n    [done, mounted, transitionableChildren]\n  )\n\n  const register = React.useCallback(\n    (childId: ID) => {\n      transitionableChildren.current.push(childId)\n      return () => unregister(childId)\n    },\n    [transitionableChildren, unregister]\n  )\n\n  return React.useMemo(\n    () => ({\n      children: transitionableChildren,\n      register,\n      unregister,\n    }),\n    [register, unregister, transitionableChildren]\n  )\n}\n\nfunction TransitionChild<TTag extends HTMLTags = 'div'>(props: TransitionChildProps<TTag>) {\n  const { children, enter, enterFrom, enterTo, leave, leaveFrom, leaveTo, ...rest } = props\n  const container = React.useRef<HTMLElement | null>(null)\n  const [state, setState] = React.useState(TreeStates.Visible)\n\n  const { show, appear } = useTransitionContext()\n  const { register, unregister } = useParentNesting()\n\n  const initial = useIsInitialRender()\n  const id = useId()\n\n  const isTransitioning = React.useRef(false)\n\n  const nesting = useNesting(\n    React.useCallback(() => {\n      // When all children have been unmounted we can only hide ourselves if and only if we are not\n      // transitioning ourserlves. Otherwise we would unmount before the transitions are finished.\n      if (!isTransitioning.current) {\n        setState(TreeStates.Hidden)\n        unregister(id)\n      }\n    }, [id, unregister, isTransitioning])\n  )\n\n  useIsoMorphicEffect(() => register(id), [register, id])\n\n  const enterClasses = useSplitClasses(enter)\n  const enterFromClasses = useSplitClasses(enterFrom)\n  const enterToClasses = useSplitClasses(enterTo)\n\n  const leaveClasses = useSplitClasses(leave)\n  const leaveFromClasses = useSplitClasses(leaveFrom)\n  const leaveToClasses = useSplitClasses(leaveTo)\n\n  React.useEffect(() => {\n    if (state === TreeStates.Visible && container.current === null) {\n      throw new Error('Did you forget to passthrough the `ref` to the actual DOM node?')\n    }\n  }, [container, state])\n\n  useIsoMorphicEffect(() => {\n    const node = container.current\n\n    if (!node) return\n\n    // Skipping initial transition\n    if (initial && !appear) return\n\n    isTransitioning.current = true\n\n    return show\n      ? transition(node, enterClasses, enterFromClasses, enterToClasses, () => {\n          isTransitioning.current = false\n        })\n      : transition(node, leaveClasses, leaveFromClasses, leaveToClasses, reason => {\n          isTransitioning.current = false\n\n          if (reason !== Reason.Finished) return\n\n          // When we don't have children anymore we can safely unregister from the parent and hide\n          // ourselves.\n          if (nesting.children.current.length <= 0) {\n            setState(TreeStates.Hidden)\n            unregister(id)\n          }\n        })\n  }, [\n    id,\n    isTransitioning,\n    unregister,\n    nesting,\n    container,\n    initial,\n    appear,\n    show,\n    enterClasses,\n    enterFromClasses,\n    enterToClasses,\n    leaveClasses,\n    leaveFromClasses,\n    leaveToClasses,\n  ])\n\n  // Unmount the whole tree\n  if (state === TreeStates.Hidden) return null\n\n  if (typeof children === 'function') {\n    return (\n      <NestingContext.Provider value={nesting}>\n        {(children as AsRenderPropFunction['children'])(container)}\n      </NestingContext.Provider>\n    )\n  }\n\n  const { as: Component = 'div', ...passthroughProps } = rest as AsShortcut<TTag>\n  return (\n    <NestingContext.Provider value={nesting}>\n      {/* @ts-expect-error Expression produces a union type that is too complex to represent. */}\n      <Component {...passthroughProps} ref={container}>\n        {children}\n      </Component>\n    </NestingContext.Provider>\n  )\n}\n\nexport function Transition<TTag extends HTMLTags = 'div'>(\n  props: TransitionChildProps<TTag> & { show: boolean; appear?: boolean }\n) {\n  const { show, appear = false, ...rest } = props\n\n  if (![true, false].includes(show)) {\n    throw new Error('A <Transition /> is used but it is missing a `show={true | false}` prop.')\n  }\n\n  const [state, setState] = React.useState(show ? TreeStates.Visible : TreeStates.Hidden)\n\n  const nestingBag = useNesting(\n    React.useCallback(() => {\n      setState(TreeStates.Hidden)\n    }, [])\n  )\n\n  const initial = useIsInitialRender()\n  const transitionBag = React.useMemo<TransitionContextValues>(\n    () => ({ show, appear: appear || !initial }),\n    [show, appear, initial]\n  )\n\n  React.useEffect(() => {\n    if (show) {\n      setState(TreeStates.Visible)\n    } else if (nestingBag.children.current.length <= 0) {\n      setState(TreeStates.Hidden)\n    }\n  }, [show, nestingBag])\n\n  return (\n    <NestingContext.Provider value={nestingBag}>\n      <TransitionContext.Provider value={transitionBag}>\n        {match(state, {\n          [TreeStates.Visible]: () => <TransitionChild {...rest} />,\n          [TreeStates.Hidden]: null,\n        })}\n      </TransitionContext.Provider>\n    </NestingContext.Provider>\n  )\n}\n\nTransition.Child = TransitionChild\n","import * as React from 'react'\nimport { Props } from '../types'\n\nexport function render<TTag extends React.ElementType, TBag>(\n  props: Props<TTag, TBag>,\n  bag: TBag,\n  tag: React.ElementType\n) {\n  const { as: Component = tag, children, ...passThroughProps } = props\n\n  const resolvedChildren = (typeof children === 'function' ? children(bag) : children) as\n    | React.ReactElement\n    | React.ReactElement[]\n\n  if (Component === React.Fragment) {\n    if (Object.keys(passThroughProps).length > 0) {\n      if (Array.isArray(resolvedChildren) && resolvedChildren.length > 1) {\n        const err = new Error('You should only render 1 child')\n        if (Error.captureStackTrace) Error.captureStackTrace(err, render)\n        throw err\n      }\n\n      if (!React.isValidElement(resolvedChildren)) {\n        const err = new Error(\n          `You should render an element as a child. Did you forget the as=\"...\" prop?`\n        )\n        if (Error.captureStackTrace) Error.captureStackTrace(err, render)\n        throw err\n      }\n\n      return React.cloneElement(\n        resolvedChildren,\n\n        // Filter out undefined values so that they don't override the existing values\n        mergeEventFunctions(compact(passThroughProps), resolvedChildren.props, ['onClick'])\n      )\n    }\n  }\n\n  return React.createElement(Component, passThroughProps, resolvedChildren)\n}\n\n/**\n * We can use this function for the following useCase:\n *\n * <Menu.Item> <button onClick={console.log} /> </Menu.Item>\n *\n * Our `Menu.Item` will have an internal `onClick`, if you passthrough an `onClick` to the actual\n * `Menu.Item` component we will call it correctly. However, when we have an `onClick` on the actual\n * first child, that one should _also_ be called (but before this implementation, it was just\n * overriding the `onClick`). But it is only when we *render* that we have access to the existing\n * props of this component.\n *\n * It's a bit hacky, and not that clean, but it is something internal and we have tests to rely on\n * so that we can refactor this later (if needed).\n */\nfunction mergeEventFunctions(\n  passThroughProps: Record<string, any>,\n  existingProps: Record<string, any>,\n  functionsToMerge: string[]\n) {\n  let clone = Object.assign({}, passThroughProps)\n  for (let func of functionsToMerge) {\n    if (passThroughProps[func] !== undefined && existingProps[func] !== undefined) {\n      Object.assign(clone, {\n        [func](event: { defaultPrevented: boolean }) {\n          // Props we control\n          if (!event.defaultPrevented) passThroughProps[func](event)\n\n          // Existing props on the component\n          if (!event.defaultPrevented) existingProps[func](event)\n        },\n      })\n    }\n  }\n\n  return clone\n}\n\n/**\n * This is a hack, but basically we want to keep the full 'API' of the component, but we do want to\n * wrap it in a forwardRef so that we _can_ passthrough the ref\n */\nexport function forwardRefWithAs<T>(component: T): T {\n  return React.forwardRef((component as unknown) as any) as any\n}\n\nfunction compact<T extends Record<any, any>>(object: T) {\n  let clone = Object.assign({}, object)\n  for (let key in clone) {\n    if (clone[key] === undefined) delete clone[key]\n  }\n  return clone\n}\n","import * as React from 'react'\n\nimport { disposables } from '../utils/disposables'\n\nexport function useDisposables() {\n  // Using useState instead of useRef so that we can use the initializer function.\n  const [d] = React.useState(disposables)\n  React.useEffect(() => () => d.dispose(), [d])\n  return d\n}\n","import * as React from 'react'\n\nexport function useSyncRefs<TType>(\n  ...refs: (React.MutableRefObject<TType> | ((instance: TType) => void) | null)[]\n) {\n  return React.useCallback(\n    (value: TType) => {\n      refs.forEach(ref => {\n        if (ref === null) return\n        if (typeof ref === 'function') return ref(value)\n        ref.current = value\n      })\n    },\n    [refs]\n  )\n}\n","// TODO: This must already exist somewhere, right? ðŸ¤”\n// Ref: https://www.w3.org/TR/uievents-key/#named-key-attribute-values\nexport enum Keys {\n  Space = ' ',\n  Enter = 'Enter',\n  Escape = 'Escape',\n  Backspace = 'Backspace',\n\n  ArrowUp = 'ArrowUp',\n  ArrowDown = 'ArrowDown',\n\n  Home = 'Home',\n  End = 'End',\n\n  PageUp = 'PageUp',\n  PageDown = 'PageDown',\n\n  Tab = 'Tab',\n}\n","// WAI-ARIA: https://www.w3.org/TR/wai-aria-practices-1.2/#menubutton\nimport * as React from 'react'\n\nimport { Props } from '../../types'\nimport { match } from '../../utils/match'\nimport { forwardRefWithAs, render } from '../../utils/render'\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\n\nenum MenuStates {\n  Open,\n  Closed,\n}\n\ntype MenuItemDataRef = React.MutableRefObject<{ textValue?: string; disabled: boolean }>\n\ntype StateDefinition = {\n  menuState: MenuStates\n  buttonRef: React.MutableRefObject<HTMLButtonElement | null>\n  itemsRef: React.MutableRefObject<HTMLDivElement | null>\n  items: { id: string; dataRef: MenuItemDataRef }[]\n  searchQuery: string\n  activeItemIndex: number | null\n}\n\nenum ActionTypes {\n  OpenMenu,\n  CloseMenu,\n\n  GoToItem,\n  Search,\n  ClearSearch,\n\n  RegisterItem,\n  UnregisterItem,\n}\n\nenum Focus {\n  FirstItem,\n  PreviousItem,\n  NextItem,\n  LastItem,\n  SpecificItem,\n  Nothing,\n}\n\nfunction calculateActiveItemIndex(\n  state: StateDefinition,\n  focus: Focus,\n  id?: string\n): StateDefinition['activeItemIndex'] {\n  if (state.items.length <= 0) return null\n\n  const items = state.items\n  const activeItemIndex = state.activeItemIndex ?? -1\n\n  const nextActiveIndex = match(focus, {\n    [Focus.FirstItem]: () => items.findIndex(item => !item.dataRef.current.disabled),\n    [Focus.PreviousItem]: () => {\n      const idx = items\n        .slice()\n        .reverse()\n        .findIndex((item, idx, all) => {\n          if (activeItemIndex !== -1 && all.length - idx - 1 >= activeItemIndex) return false\n          return !item.dataRef.current.disabled\n        })\n      if (idx === -1) return idx\n      return items.length - 1 - idx\n    },\n    [Focus.NextItem]: () => {\n      return items.findIndex((item, idx) => {\n        if (idx <= activeItemIndex) return false\n        return !item.dataRef.current.disabled\n      })\n    },\n    [Focus.LastItem]: () => {\n      const idx = items\n        .slice()\n        .reverse()\n        .findIndex(item => !item.dataRef.current.disabled)\n      if (idx === -1) return idx\n      return items.length - 1 - idx\n    },\n    [Focus.SpecificItem]: () => items.findIndex(item => item.id === id),\n    [Focus.Nothing]: () => null,\n  })\n\n  if (nextActiveIndex === -1) return state.activeItemIndex\n  return nextActiveIndex\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseMenu }\n  | { type: ActionTypes.OpenMenu }\n  | { type: ActionTypes.GoToItem; focus: Focus; id?: string }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterItem; id: string; dataRef: MenuItemDataRef }\n  | { type: ActionTypes.UnregisterItem; id: string }\n\nconst reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseMenu]: state => ({ ...state, menuState: MenuStates.Closed }),\n  [ActionTypes.OpenMenu]: state => ({ ...state, menuState: MenuStates.Open }),\n  [ActionTypes.GoToItem]: (state, action) => {\n    const activeItemIndex = calculateActiveItemIndex(state, action.focus, action.id)\n\n    if (state.searchQuery === '' && state.activeItemIndex === activeItemIndex) {\n      return state\n    }\n\n    return {\n      ...state,\n      searchQuery: '',\n      activeItemIndex,\n    }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    const searchQuery = state.searchQuery + action.value\n    const match = state.items.findIndex(\n      item =>\n        item.dataRef.current.textValue?.startsWith(searchQuery) && !item.dataRef.current.disabled\n    )\n\n    if (match === -1 || match === state.activeItemIndex) {\n      return { ...state, searchQuery }\n    }\n\n    return {\n      ...state,\n      searchQuery,\n      activeItemIndex: match,\n    }\n  },\n  [ActionTypes.ClearSearch]: state => ({ ...state, searchQuery: '' }),\n  [ActionTypes.RegisterItem]: (state, action) => ({\n    ...state,\n    items: [...state.items, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterItem]: (state, action) => {\n    const nextItems = state.items.slice()\n    const currentActiveItem =\n      state.activeItemIndex !== null ? nextItems[state.activeItemIndex] : null\n\n    const idx = nextItems.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextItems.splice(idx, 1)\n\n    return {\n      ...state,\n      items: nextItems,\n      activeItemIndex: (() => {\n        if (idx === state.activeItemIndex) return null\n        if (currentActiveItem === null) return null\n\n        // If we removed the item before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextItems.indexOf(currentActiveItem)\n      })(),\n    }\n  },\n}\n\nconst MenuContext = React.createContext<[StateDefinition, React.Dispatch<Actions>] | null>(null)\n\nfunction useMenuContext(component: string) {\n  const context = React.useContext(MenuContext)\n  if (context === null) {\n    const err = new Error(`<${component} /> is missing a parent <${Menu.name} /> component.`)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(err, useMenuContext)\n    }\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nconst DEFAULT_MENU_TAG = React.Fragment\n\ntype MenuRenderPropArg = { open: boolean }\n\nexport function Menu<TTag extends React.ElementType = typeof DEFAULT_MENU_TAG>(\n  props: Props<TTag, MenuRenderPropArg>\n) {\n  const d = useDisposables()\n  const reducerBag = React.useReducer(stateReducer, {\n    menuState: MenuStates.Closed,\n    buttonRef: React.createRef(),\n    itemsRef: React.createRef(),\n    items: [],\n    searchQuery: '',\n    activeItemIndex: null,\n  } as StateDefinition)\n  const [{ menuState, itemsRef, buttonRef }, dispatch] = reducerBag\n\n  React.useEffect(() => {\n    function handler(event: MouseEvent) {\n      if (menuState !== MenuStates.Open) return\n      if (buttonRef.current?.contains(event.target as HTMLElement)) return\n\n      if (!itemsRef.current?.contains(event.target as HTMLElement)) {\n        dispatch({ type: ActionTypes.CloseMenu })\n        if (!event.defaultPrevented) buttonRef.current?.focus()\n      }\n    }\n\n    window.addEventListener('click', handler)\n    return () => window.removeEventListener('click', handler)\n  }, [menuState, itemsRef, buttonRef, d, dispatch])\n\n  const propsBag = React.useMemo(() => ({ open: menuState === MenuStates.Open }), [menuState])\n\n  return (\n    <MenuContext.Provider value={reducerBag}>\n      {render(props, propsBag, DEFAULT_MENU_TAG)}\n    </MenuContext.Provider>\n  )\n}\n\n// ---\n\ntype ButtonPropsWeControl =\n  | 'ref'\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'onKeyDown'\n  | 'onFocus'\n  | 'onBlur'\n  | 'onPointerUp'\n\nconst DEFAULT_BUTTON_TAG = 'button'\n\ntype ButtonRenderPropArg = { open: boolean; focused: boolean }\n\nconst Button = forwardRefWithAs(function Button<\n  TTag extends React.ElementType = typeof DEFAULT_BUTTON_TAG\n>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: React.Ref<HTMLButtonElement>\n) {\n  const [state, dispatch] = useMenuContext([Menu.name, Button.name].join('.'))\n  const buttonRef = useSyncRefs(state.buttonRef, ref)\n  const [focused, setFocused] = React.useState(false)\n\n  const id = `headlessui-menu-button-${useId()}`\n  const d = useDisposables()\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => {\n            state.itemsRef.current?.focus()\n            dispatch({ type: ActionTypes.GoToItem, focus: Focus.FirstItem })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => {\n            state.itemsRef.current?.focus()\n            dispatch({ type: ActionTypes.GoToItem, focus: Focus.LastItem })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  const handlePointerUp = React.useCallback(\n    (event: MouseEvent) => {\n      if (state.menuState === MenuStates.Open) {\n        dispatch({ type: ActionTypes.CloseMenu })\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenMenu })\n        d.nextFrame(() => state.itemsRef.current?.focus())\n      }\n    },\n    [dispatch, d, state]\n  )\n\n  const handleFocus = React.useCallback(() => {\n    if (state.menuState === MenuStates.Open) state.itemsRef.current?.focus()\n    setFocused(true)\n  }, [state, setFocused])\n\n  const handleBlur = React.useCallback(() => setFocused(false), [setFocused])\n\n  const propsBag = React.useMemo(() => ({ open: state.menuState === MenuStates.Open, focused }), [\n    state,\n    focused,\n  ])\n  const passthroughProps = props\n  const propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': state.itemsRef.current?.id,\n    'aria-expanded': state.menuState === MenuStates.Open ? true : undefined,\n    onKeyDown: handleKeyDown,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    onPointerUp: handlePointerUp,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_BUTTON_TAG)\n})\n\n// ---\n\ntype ItemsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'id'\n  | 'onKeyDown'\n  | 'ref'\n  | 'role'\n  | 'tabIndex'\n\nconst DEFAULT_ITEMS_TAG = 'div'\n\ntype ItemsRenderPropArg = { open: boolean }\n\nconst Items = forwardRefWithAs(function Items<\n  TTag extends React.ElementType = typeof DEFAULT_ITEMS_TAG\n>(\n  props: Props<TTag, ItemsRenderPropArg, ItemsPropsWeControl> & { static?: boolean },\n  ref: React.Ref<HTMLDivElement>\n) {\n  const { static: isStatic = false, ...passthroughProps } = props\n  const [state, dispatch] = useMenuContext([Menu.name, Items.name].join('.'))\n  const itemsRef = useSyncRefs(state.itemsRef, ref)\n\n  const id = `headlessui-menu-items-${useId()}`\n  const d = useDisposables()\n  const searchDisposables = useDisposables()\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseMenu })\n          if (state.activeItemIndex !== null) {\n            const { id } = state.items[state.activeItemIndex]\n            document.getElementById(id)?.click()\n            d.nextFrame(() => state.buttonRef.current?.focus())\n          }\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.NextItem })\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.PreviousItem })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.FirstItem })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.LastItem })\n\n        case Keys.Escape:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseMenu })\n          d.nextFrame(() => state.buttonRef.current?.focus())\n          break\n\n        case Keys.Tab:\n          return event.preventDefault()\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [d, dispatch, searchDisposables, state]\n  )\n\n  const propsBag = React.useMemo(() => ({ open: state.menuState === MenuStates.Open }), [state])\n  const propsWeControl = {\n    'aria-activedescendant':\n      state.activeItemIndex === null ? undefined : state.items[state.activeItemIndex]?.id,\n    'aria-labelledby': state.buttonRef.current?.id,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'menu',\n    tabIndex: 0,\n  }\n\n  if (!isStatic && state.menuState === MenuStates.Closed) return null\n\n  return render(\n    { ...passthroughProps, ...propsWeControl, ...{ ref: itemsRef } },\n    propsBag,\n    DEFAULT_ITEMS_TAG\n  )\n})\n\n// ---\n\ntype MenuItemPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'onPointerLeave'\n  | 'onFocus'\n\nconst DEFAULT_ITEM_TAG = React.Fragment\n\ntype ItemRenderPropArg = { active: boolean; disabled: boolean }\n\nfunction Item<TTag extends React.ElementType = typeof DEFAULT_ITEM_TAG>(\n  props: Props<TTag, ItemRenderPropArg, MenuItemPropsWeControl | 'className'> & {\n    disabled?: boolean\n    onClick?: (event: { preventDefault: Function }) => void\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: ItemRenderPropArg) => string) | string\n  }\n) {\n  const { disabled = false, className, onClick, ...passthroughProps } = props\n  const [state, dispatch] = useMenuContext([Menu.name, Item.name].join('.'))\n  const d = useDisposables()\n  const id = `headlessui-menu-item-${useId()}`\n  const active =\n    state.activeItemIndex !== null ? state.items[state.activeItemIndex].id === id : false\n\n  const bag = React.useRef<MenuItemDataRef['current']>({ disabled })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterItem, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterItem, id })\n  }, [bag, id])\n\n  const handleClick = React.useCallback(\n    (event: { preventDefault: Function }) => {\n      if (disabled) return event.preventDefault()\n      dispatch({ type: ActionTypes.CloseMenu })\n      d.nextFrame(() => state.buttonRef.current?.focus())\n      if (onClick) return onClick(event)\n    },\n    [d, dispatch, state.buttonRef, disabled, onClick]\n  )\n\n  const handleFocus = React.useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.SpecificItem, id })\n  }, [disabled, id, dispatch])\n\n  const handlePointerMove = React.useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.SpecificItem, id })\n  }, [disabled, active, id, dispatch])\n\n  const handlePointerLeave = React.useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  const propsBag = React.useMemo(() => ({ active, disabled }), [active, disabled])\n  const propsWeControl = {\n    id,\n    role: 'menuitem',\n    tabIndex: -1,\n    className: resolvePropValue(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handlePointerMove,\n    onPointerLeave: handlePointerLeave,\n  }\n\n  return render<TTag, ItemRenderPropArg>(\n    { ...passthroughProps, ...propsWeControl },\n    propsBag,\n    DEFAULT_ITEM_TAG\n  )\n}\n\nfunction resolvePropValue<TProperty, TBag>(property: TProperty, bag: TBag) {\n  if (property === undefined) return undefined\n  if (typeof property === 'function') return property(bag)\n  return property\n}\n\n// ---\n\nMenu.Button = Button\nMenu.Items = Items\nMenu.Item = Item\n","import * as React from 'react'\nimport { useIsoMorphicEffect } from './use-iso-morphic-effect'\n\nexport function useComputed<T>(cb: () => T, dependencies: React.DependencyList) {\n  const [value, setValue] = React.useState(cb)\n  const cbRef = React.useRef(cb)\n  useIsoMorphicEffect(() => {\n    cbRef.current = cb\n  }, [cb])\n  useIsoMorphicEffect(() => setValue(cbRef.current), [cbRef, setValue, ...dependencies])\n  return value\n}\n","import * as React from 'react'\n\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useId } from '../../hooks/use-id'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useComputed } from '../../hooks/use-computed'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { Props } from '../../types'\nimport { forwardRefWithAs, render } from '../../utils/render'\nimport { match } from '../../utils/match'\nimport { disposables } from '../../utils/disposables'\nimport { Keys } from '../keyboard'\n\nenum ListboxStates {\n  Open,\n  Closed,\n}\n\ntype ListboxOptionDataRef = React.MutableRefObject<{\n  textValue?: string\n  disabled: boolean\n  value: unknown\n}>\n\ntype StateDefinition = {\n  listboxState: ListboxStates\n  propsRef: React.MutableRefObject<{ value: unknown; onChange(value: unknown): void }>\n  labelRef: React.MutableRefObject<HTMLLabelElement | null>\n  buttonRef: React.MutableRefObject<HTMLButtonElement | null>\n  optionsRef: React.MutableRefObject<HTMLUListElement | null>\n  options: { id: string; dataRef: ListboxOptionDataRef }[]\n  searchQuery: string\n  activeOptionIndex: number | null\n}\n\nenum ActionTypes {\n  OpenListbox,\n  CloseListbox,\n\n  GoToOption,\n  Search,\n  ClearSearch,\n\n  RegisterOption,\n  UnregisterOption,\n}\n\nenum Focus {\n  First,\n  Previous,\n  Next,\n  Last,\n  Specific,\n  Nothing,\n}\n\nfunction calculateActiveOptionIndex(\n  state: StateDefinition,\n  focus: Focus,\n  id?: string\n): StateDefinition['activeOptionIndex'] {\n  if (state.options.length <= 0) return null\n\n  const options = state.options\n  const activeOptionIndex = state.activeOptionIndex ?? -1\n\n  const nextActiveIndex = match(focus, {\n    [Focus.First]: () => options.findIndex(option => !option.dataRef.current.disabled),\n    [Focus.Previous]: () => {\n      const idx = options\n        .slice()\n        .reverse()\n        .findIndex((option, idx, all) => {\n          if (activeOptionIndex !== -1 && all.length - idx - 1 >= activeOptionIndex) return false\n          return !option.dataRef.current.disabled\n        })\n      if (idx === -1) return idx\n      return options.length - 1 - idx\n    },\n    [Focus.Next]: () => {\n      return options.findIndex((option, idx) => {\n        if (idx <= activeOptionIndex) return false\n        return !option.dataRef.current.disabled\n      })\n    },\n    [Focus.Last]: () => {\n      const idx = options\n        .slice()\n        .reverse()\n        .findIndex(option => !option.dataRef.current.disabled)\n      if (idx === -1) return idx\n      return options.length - 1 - idx\n    },\n    [Focus.Specific]: () => options.findIndex(option => option.id === id),\n    [Focus.Nothing]: () => null,\n  })\n\n  if (nextActiveIndex === -1) return state.activeOptionIndex\n  return nextActiveIndex\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseListbox }\n  | { type: ActionTypes.OpenListbox }\n  | { type: ActionTypes.GoToOption; focus: Focus; id?: string }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterOption; id: string; dataRef: ListboxOptionDataRef }\n  | { type: ActionTypes.UnregisterOption; id: string }\n\nconst reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseListbox]: state => ({ ...state, listboxState: ListboxStates.Closed }),\n  [ActionTypes.OpenListbox]: state => ({ ...state, listboxState: ListboxStates.Open }),\n  [ActionTypes.GoToOption]: (state, action) => {\n    const activeOptionIndex = calculateActiveOptionIndex(state, action.focus, action.id)\n\n    if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) {\n      return state\n    }\n\n    return { ...state, searchQuery: '', activeOptionIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    const searchQuery = state.searchQuery + action.value\n    const match = state.options.findIndex(\n      option =>\n        !option.dataRef.current.disabled &&\n        option.dataRef.current.textValue?.startsWith(searchQuery)\n    )\n\n    if (match === -1 || match === state.activeOptionIndex) {\n      return { ...state, searchQuery }\n    }\n\n    return { ...state, searchQuery, activeOptionIndex: match }\n  },\n  [ActionTypes.ClearSearch]: state => ({ ...state, searchQuery: '' }),\n  [ActionTypes.RegisterOption]: (state, action) => ({\n    ...state,\n    options: [...state.options, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterOption]: (state, action) => {\n    const nextOptions = state.options.slice()\n    const currentActiveOption =\n      state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null\n\n    const idx = nextOptions.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextOptions.splice(idx, 1)\n\n    return {\n      ...state,\n      options: nextOptions,\n      activeOptionIndex: (() => {\n        if (idx === state.activeOptionIndex) return null\n        if (currentActiveOption === null) return null\n\n        // If we removed the option before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextOptions.indexOf(currentActiveOption)\n      })(),\n    }\n  },\n}\n\nconst ListboxContext = React.createContext<[StateDefinition, React.Dispatch<Actions>] | null>(null)\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\nfunction useListboxContext(component: string) {\n  const context = React.useContext(ListboxContext)\n  if (context === null) {\n    const err = new Error(`<${component} /> is missing a parent <${Listbox.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext)\n    throw err\n  }\n  return context\n}\n\n// ---\n\nconst DEFAULT_LISTBOX_TAG = React.Fragment\n\ntype ListboxRenderPropArg = { open: boolean }\n\nexport function Listbox<\n  TTag extends React.ElementType = typeof DEFAULT_LISTBOX_TAG,\n  TType = string\n>(props: Props<TTag, ListboxRenderPropArg> & { value: TType; onChange(value: TType): void }) {\n  const { value, onChange, ...passThroughProps } = props\n  const d = useDisposables()\n  const reducerBag = React.useReducer(stateReducer, {\n    listboxState: ListboxStates.Closed,\n    propsRef: { current: { value, onChange } },\n    labelRef: React.createRef(),\n    buttonRef: React.createRef(),\n    optionsRef: React.createRef(),\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null,\n  } as StateDefinition)\n  const [{ listboxState, propsRef, optionsRef, buttonRef }, dispatch] = reducerBag\n\n  useIsoMorphicEffect(() => {\n    propsRef.current.value = value\n  }, [value, propsRef])\n  useIsoMorphicEffect(() => {\n    propsRef.current.onChange = onChange\n  }, [onChange, propsRef])\n\n  React.useEffect(() => {\n    function handler(event: MouseEvent) {\n      if (listboxState !== ListboxStates.Open) return\n      if (buttonRef.current?.contains(event.target as HTMLElement)) return\n\n      if (!optionsRef.current?.contains(event.target as HTMLElement)) {\n        dispatch({ type: ActionTypes.CloseListbox })\n        if (!event.defaultPrevented) buttonRef.current?.focus()\n      }\n    }\n\n    window.addEventListener('click', handler)\n    return () => window.removeEventListener('click', handler)\n  }, [listboxState, optionsRef, buttonRef, d, dispatch])\n\n  const propsBag = React.useMemo<ListboxRenderPropArg>(\n    () => ({ open: listboxState === ListboxStates.Open }),\n    [listboxState]\n  )\n\n  return (\n    <ListboxContext.Provider value={reducerBag}>\n      {render(passThroughProps, propsBag, DEFAULT_LISTBOX_TAG)}\n    </ListboxContext.Provider>\n  )\n}\n\n// ---\n\ntype ButtonPropsWeControl =\n  | 'ref'\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'aria-labelledby'\n  | 'onKeyDown'\n  | 'onFocus'\n  | 'onBlur'\n  | 'onPointerUp'\n\nconst DEFAULT_BUTTON_TAG = 'button'\n\ntype ButtonRenderPropArg = { open: boolean; focused: boolean }\n\nconst Button = forwardRefWithAs(function Button<\n  TTag extends React.ElementType = typeof DEFAULT_BUTTON_TAG\n>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: React.Ref<HTMLButtonElement>\n) {\n  const [state, dispatch] = useListboxContext([Listbox.name, Button.name].join('.'))\n  const buttonRef = useSyncRefs(state.buttonRef, ref)\n  const [focused, setFocused] = React.useState(false)\n\n  const id = `headlessui-listbox-button-${useId()}`\n  const d = useDisposables()\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            state.optionsRef.current?.focus()\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            state.optionsRef.current?.focus()\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  const handlePointerUp = React.useCallback(\n    (event: MouseEvent) => {\n      if (state.listboxState === ListboxStates.Open) {\n        dispatch({ type: ActionTypes.CloseListbox })\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenListbox })\n        d.nextFrame(() => state.optionsRef.current?.focus())\n      }\n    },\n    [dispatch, d, state]\n  )\n\n  const handleFocus = React.useCallback(() => {\n    if (state.listboxState === ListboxStates.Open) return state.optionsRef.current?.focus()\n    setFocused(true)\n  }, [state, setFocused])\n\n  const handleBlur = React.useCallback(() => setFocused(false), [setFocused])\n  const labelledby = useComputed(() => {\n    if (!state.labelRef.current) return undefined\n    return [state.labelRef.current.id, id].join(' ')\n  }, [state.labelRef.current, id])\n\n  const propsBag = React.useMemo<ButtonRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, focused }),\n    [state, focused]\n  )\n  const passthroughProps = props\n  const propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': state.optionsRef.current?.id,\n    'aria-expanded': state.listboxState === ListboxStates.Open ? true : undefined,\n    'aria-labelledby': labelledby,\n    onKeyDown: handleKeyDown,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    onPointerUp: handlePointerUp,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_BUTTON_TAG)\n})\n\n// ---\n\ntype LabelPropsWeControl = 'id' | 'ref' | 'onPointerUp'\n\nconst DEFAULT_LABEL_TAG = 'label'\n\ntype LabelRenderPropArg = { open: boolean }\n\nfunction Label<TTag extends React.ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  const [state] = useListboxContext([Listbox.name, Label.name].join('.'))\n  const id = `headlessui-listbox-label-${useId()}`\n\n  const handlePointerUp = React.useCallback(() => state.buttonRef.current?.focus(), [\n    state.buttonRef,\n  ])\n\n  const propsBag = React.useMemo<OptionsRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open }),\n    [state]\n  )\n  const propsWeControl = {\n    ref: state.labelRef,\n    id,\n    onPointerUp: handlePointerUp,\n  }\n  return render({ ...props, ...propsWeControl }, propsBag, DEFAULT_LABEL_TAG)\n}\n\n// ---\n\ntype OptionsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'id'\n  | 'onKeyDown'\n  | 'ref'\n  | 'role'\n  | 'tabIndex'\n\nconst DEFAULT_OPTIONS_TAG = 'ul'\n\ntype OptionsRenderPropArg = { open: boolean }\n\ntype ListboxOptionsProp<TTag> = Props<TTag, OptionsRenderPropArg, OptionsPropsWeControl> & {\n  static?: boolean\n}\n\nconst Options = forwardRefWithAs(function Options<\n  TTag extends React.ElementType = typeof DEFAULT_OPTIONS_TAG\n>(props: ListboxOptionsProp<TTag>, ref: React.Ref<HTMLUListElement>) {\n  const {\n    enter,\n    enterFrom,\n    enterTo,\n    leave,\n    leaveFrom,\n    leaveTo,\n    static: isStatic = false,\n    ...passthroughProps\n  } = props\n  const [state, dispatch] = useListboxContext([Listbox.name, Options.name].join('.'))\n  const optionsRef = useSyncRefs(state.optionsRef, ref)\n\n  const id = `headlessui-listbox-options-${useId()}`\n  const d = useDisposables()\n  const searchDisposables = useDisposables()\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent<HTMLUListElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseListbox })\n          if (state.activeOptionIndex !== null) {\n            const { dataRef } = state.options[state.activeOptionIndex]\n            state.propsRef.current.onChange(dataRef.current.value)\n          }\n          d.nextFrame(() => state.buttonRef.current?.focus())\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Next })\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseListbox })\n          return d.nextFrame(() => state.buttonRef.current?.focus())\n\n        case Keys.Tab:\n          return event.preventDefault()\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [d, dispatch, searchDisposables, state]\n  )\n\n  const labelledby = useComputed(() => state.labelRef.current?.id ?? state.buttonRef.current?.id, [\n    state.labelRef.current,\n    state.buttonRef.current,\n  ])\n\n  const propsBag = React.useMemo<OptionsRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open }),\n    [state]\n  )\n  const propsWeControl = {\n    'aria-activedescendant':\n      state.activeOptionIndex === null ? undefined : state.options[state.activeOptionIndex]?.id,\n    'aria-labelledby': labelledby,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0,\n  }\n\n  if (!isStatic && state.listboxState === ListboxStates.Closed) return null\n\n  return render(\n    { ...passthroughProps, ...propsWeControl, ...{ ref: optionsRef } },\n    propsBag,\n    DEFAULT_OPTIONS_TAG\n  )\n})\n\n// ---\n\ntype ListboxOptionPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'aria-selected'\n  | 'onPointerLeave'\n  | 'onFocus'\n\nconst DEFAULT_OPTION_TAG = 'li'\n\ntype OptionRenderPropArg = { active: boolean; selected: boolean; disabled: boolean }\n\nfunction Option<TTag extends React.ElementType = typeof DEFAULT_OPTION_TAG, TType = string>(\n  props: Props<TTag, OptionRenderPropArg, ListboxOptionPropsWeControl | 'className'> & {\n    disabled?: boolean\n    value: TType\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: OptionRenderPropArg) => string) | string\n  }\n) {\n  const { disabled = false, value, className, ...passthroughProps } = props\n  const [state, dispatch] = useListboxContext([Listbox.name, Option.name].join('.'))\n  const d = useDisposables()\n  const id = `headlessui-listbox-option-${useId()}`\n  const active =\n    state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false\n  const selected = state.propsRef.current.value === value\n\n  const bag = React.useRef<ListboxOptionDataRef['current']>({ disabled, value })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n  useIsoMorphicEffect(() => {\n    bag.current.value = value\n  }, [bag, value])\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  const select = React.useCallback(() => state.propsRef.current.onChange(value), [\n    state.propsRef,\n    value,\n  ])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterOption, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterOption, id })\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    if (!selected) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n    document.getElementById(id)?.focus?.()\n  }, [])\n\n  useIsoMorphicEffect(() => {\n    if (!active) return\n    const d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [active])\n\n  const handleClick = React.useCallback(\n    (event: { preventDefault: Function }) => {\n      if (disabled) return event.preventDefault()\n      select()\n      dispatch({ type: ActionTypes.CloseListbox })\n      d.nextFrame(() => state.buttonRef.current?.focus())\n    },\n    [d, dispatch, state.buttonRef, disabled, select]\n  )\n\n  const handleFocus = React.useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  const handlePointerMove = React.useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  const handlePointerLeave = React.useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  const propsBag = React.useMemo(() => ({ active, selected, disabled }), [\n    active,\n    selected,\n    disabled,\n  ])\n  const propsWeControl = {\n    id,\n    role: 'option',\n    tabIndex: -1,\n    className: resolvePropValue(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handlePointerMove,\n    onPointerLeave: handlePointerLeave,\n  }\n\n  return render<TTag, OptionRenderPropArg>(\n    { ...passthroughProps, ...propsWeControl },\n    propsBag,\n    DEFAULT_OPTION_TAG\n  )\n}\n\nfunction resolvePropValue<TProperty, TBag>(property: TProperty, bag: TBag) {\n  if (property === undefined) return undefined\n  if (typeof property === 'function') return property(bag)\n  return property\n}\n\n// ---\n\nListbox.Button = Button\nListbox.Label = Label\nListbox.Options = Options\nListbox.Option = Option\n","import * as React from 'react'\n\nimport { Props } from '../../types'\nimport { render } from '../../utils/render'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\n\ntype StateDefinition = {\n  switch: HTMLButtonElement | null\n  label: HTMLLabelElement | null\n\n  setSwitch(element: HTMLButtonElement): void\n  setLabel(element: HTMLLabelElement): void\n}\n\nconst GroupContext = React.createContext<StateDefinition | null>(null)\n\nfunction useGroupContext(component: string) {\n  const context = React.useContext(GroupContext)\n  if (context === null) {\n    const err = new Error(`<${component} /> is missing a parent <Switch.Group /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useGroupContext)\n    throw err\n  }\n  return context\n}\n\n// ---\n\nconst DEFAULT_GROUP_TAG = React.Fragment\n\ntype GroupRenderPropArg = {}\n\nfunction Group<TTag extends React.ElementType = typeof DEFAULT_GROUP_TAG>(\n  props: Props<TTag, GroupRenderPropArg>\n) {\n  const [switchElement, setSwitchElement] = React.useState<HTMLButtonElement | null>(null)\n  const [labelElement, setLabelElement] = React.useState<HTMLLabelElement | null>(null)\n\n  const context = React.useMemo<StateDefinition>(\n    () => ({\n      switch: switchElement,\n      label: labelElement,\n      setSwitch: setSwitchElement,\n      setLabel: setLabelElement,\n    }),\n    [switchElement, setSwitchElement, labelElement, setLabelElement]\n  )\n  return (\n    <GroupContext.Provider value={context}>\n      {render(props, {}, DEFAULT_GROUP_TAG)}\n    </GroupContext.Provider>\n  )\n}\n\n// ---\n\nconst DEFAULT_SWITCH_TAG = 'button'\n\ntype SwitchRenderPropArg = { checked: boolean }\n\ntype SwitchPropsWeControl = 'id' | 'role' | 'tabIndex' | 'aria-checked' | 'onClick' | 'onKeyDown'\n\nexport function Switch<TTag extends React.ElementType = typeof DEFAULT_SWITCH_TAG>(\n  props: Props<\n    TTag,\n    SwitchRenderPropArg,\n    SwitchPropsWeControl | 'checked' | 'onChange' | 'className'\n  > & {\n    checked: boolean\n    onChange(checked: boolean): void\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: SwitchRenderPropArg) => string) | string\n  }\n) {\n  const { checked, onChange, className, ...passThroughProps } = props\n  const id = `headlessui-switch-${useId()}`\n  const groupContext = React.useContext(GroupContext)\n\n  const toggle = React.useCallback(() => onChange(!checked), [onChange, checked])\n  const handleClick = React.useCallback(\n    (event: React.MouseEvent) => {\n      event.preventDefault()\n      toggle()\n    },\n    [toggle]\n  )\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent<HTMLElement>) => {\n      event.preventDefault()\n      if (event.key === Keys.Space) toggle()\n    },\n    [toggle]\n  )\n\n  const propsBag = React.useMemo<SwitchRenderPropArg>(() => ({ checked }), [checked])\n  const propsWeControl = {\n    id,\n    ref: groupContext === null ? undefined : groupContext.setSwitch,\n    role: 'switch',\n    tabIndex: 0,\n    className: resolvePropValue(className, propsBag),\n    'aria-checked': checked,\n    'aria-labelledby': groupContext?.label?.id,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown,\n  }\n\n  return render({ ...passThroughProps, ...propsWeControl }, propsBag, DEFAULT_SWITCH_TAG)\n}\n\n// ---\n\ntype LabelPropsWeControl = 'id' | 'ref' | 'onPointerUp'\n\nconst DEFAULT_LABEL_TAG = 'label'\n\ntype LabelRenderPropArg = {}\n\nfunction Label<TTag extends React.ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  const state = useGroupContext([Switch.name, Label.name].join('.'))\n  const id = `headlessui-switch-label-${useId()}`\n\n  const handlePointerUp = React.useCallback(() => {\n    if (!state.switch) return\n    state.switch.click()\n    state.switch.focus()\n  }, [state.switch])\n\n  const propsWeControl = {\n    ref: state.setLabel,\n    id,\n    onPointerUp: handlePointerUp,\n  }\n  return render({ ...props, ...propsWeControl }, {}, DEFAULT_LABEL_TAG)\n}\n\n// ---\n\nSwitch.Group = Group\nSwitch.Label = Label\n\n// ---\n\nfunction resolvePropValue<TProperty, TBag>(property: TProperty, bag: TBag) {\n  if (property === undefined) return undefined\n  if (typeof property === 'function') return property(bag)\n  return property\n}\n"]},"metadata":{},"sourceType":"module"}